window.NwsApi=(()=>{"use strict";var t={423:(t,e,r)=>{r.r(e),r.d(e,{Alert:()=>i,Forecast:()=>a,Product:()=>l});class s{constructor(){}async retryFetch(t,e,r,s){try{let r=await fetch(t,e);if(r.ok)return r;throw new Error("Request to "+t+" failed: "+r.statusText)}catch(i){if(1===s)throw i;return await this.sleep(r),await this.retryFetch(t,e,r,s-1)}}async retryFetchAllJson(t,e,r,s){return await Promise.all(t.map((async t=>(await this.retryFetch(t,e,r,s)).json())))}async sleep(t){return new Promise((e=>setTimeout(e,t)))}buildGetUrl(t,e){let r=t+"?";for(let[t,s]of Object.entries(e))if(null!==s){let e=t,i="";i=Array.isArray(s)?s.join(","):s.toString(),r+="&"+e+"="+i}return r=encodeURI(r),r}}class i extends s{constructor(t,e){super(),this._queryUrl="https://api.weather.gov/alerts",this._requestRetryLimit=4,this._requestRetryTimeout=4e3,this._filters={active:null,start:null,end:null,status:null,message_type:null,event:null,code:null,region_type:null,point:null,region:null,area:null,zone:null,urgency:null,certainty:null,severity:null,limit:null,cursor:null,product:null,siteid:null,zone:null,county:null,latlon:null,newprop:null},this.returnObj={updated:null,features:null},this._filters=Object.assign(this._filters,t)}async getAll(t,...e){let r=this.buildGetUrl(this._queryUrl,this._filters);try{const t=await this.retryFetch(r,null,this._requestRetryTimeout,this._requestRetryLimit);let e=await t.json();this.returnObj.updated=new Date(e.updated),this.returnObj.features=e.features}catch{console.error("NWS API Unavailable or Bad Request: "+r),this.returnObj=!1}if(!t)return this.returnObj;t(this.returnObj,...e)}}class a extends s{constructor(t,e){super(),this._baseUrl="https://api.weather.gov/",this._pointsUrl="points/",this._gridpointsUrl="gridpoints/",this._fcstHourlyUrl="forecast/hourly",this._fcstSummaryUrl="forecast",this._requestRetryLimit=4,this._requestRetryTimeout=4e3,this._lat=t,this._lon=e,this._metaData=null,this._rawForecast=null,this._summaryForecast=null,this._hourlyForecast=null}async getRawForecast(t,...e){if(this._rawForecast||await this.queryRawForecast(),!t)return this._rawForecast;t(json,...e)}async getHourlyForecast(t,...e){if(this._hourlyForecast||await this.queryHourlyForecast(),!t)return this._hourlyForecast;t(json,...e)}async getSummaryForecast(t,...e){if(this._summaryForecast||await this.querySummaryForecast(),!t)return this._summaryForecast;t(json,...e)}async getMetaData(){return this._metaData||await this.queryPointMetadata(),this._metaData}get gridX(){return this._metaData.properties.gridX}get gridY(){return this._metaData.properties.gridY}get cwa(){return this._metaData.properties.cwa}async queryPointMetadata(){var t=this._baseUrl+this._pointsUrl+this._lat+","+this._lon;const e=await this.retryFetch(t);this._metaData=await e.json()}async queryRawForecast(t,...e){this._metaData||await this.queryPointMetadata();var r=this._baseUrl+this._gridpointsUrl+this.cwa+"/"+this.gridX+","+this.gridY;const s=await this.retryFetch(r),i=await s.json();this._rawForecast=i}async queryHourlyForecast(t,...e){this._metaData||await this.queryPointMetadata();var r=this._baseUrl+this._gridpointsUrl+this.cwa+"/"+this.gridX+","+this.gridY+"/"+this._fcstHourlyUrl;const s=await this.retryFetch(r),i=await s.json();this._hourlyForecast=i}async querySummaryForecast(t,...e){this._metaData||await this.queryPointMetadata();var r=this._baseUrl+this._gridpointsUrl+this.cwa+"/"+this.gridX+","+this.gridY+"/"+this._fcstSummaryUrl;const s=await this.retryFetch(r),i=await s.json();this._summaryForecast=i}async getForecasts(t,e,...r){let s={};if(t.includes("raw")&&(s.raw=await this.getRawForecast()),t.includes("hourly")&&(s.hourly=await this.getHourlyForecast()),t.includes("summary")&&(s.summary=await this.getSummaryForecast()),!e)return s;e(s,...r)}async getRawWeatherDataBetweenPeriods(t,e,r){this._rawForecast||await this.getRawForecast();let s=this._rawForecast.properties[t].values,i=[],a=[],l=!1;return"quantitativePrecipitation"==t&&(l="split"),s.forEach((t=>{i=i.concat(this.hourlyForecastFromRaw(t,l))})),a=i.filter((t=>{if(t.startDate>=e&&t.endDate<=r)return!0})),a}}class l extends s{constructor(t,e){super(),this._queryUrl="https://api.weather.gov/products",this._requestRetryLimit=4,this._requestRetryTimeout=1e3,this._getMostRecentLimit=50,this._getAllLimit=250,this._filters={location:null,start:null,end:null,office:null,wmoid:null,type:null,limit:null},this._productListing=!1,this.returnObj={updated:null,features:null},this._filters=Object.assign(this._filters,t)}async getFullProductListing(){let t=this.buildGetUrl(this._queryUrl,this._filters);try{const e=await this.retryFetch(t,null,this._requestRetryTimeout,this._requestRetryLimit);let r=await e.json();return this._productListing=r["@graph"],this._productListing}catch{throw new Error("NWS API Unavailable or Bad Request: "+t)}}async getMostRecent(t=1,e,...r){t>this._mostRecentLimit&&(t=this._mostRecentLimit),this._productListing||await this.getFullProductListing();let s=this._productListing.slice(0,t),i=await this.getProductsFulltext(s);if(!e)return i;e(i,...r)}async getAll(t,...e){let r=[];r=this._productListing?this._productListing:await this.getFullProductListing(),r.length>this._getAllLimit&&(r=r.slice(0,this._getAllLimit));let s=await this.getMultipleProductsFulltext(r);if(!t)return s;t(s,...e)}async getProductsFulltext(t){let e=[];if(0!==t.length){let r=t.map((t=>t["@id"]));e=await this.retryFetchAllJson(r,null,this._requestRetryTimeout,this._requestRetryLimit)}return console.log(e),e}}}},e={};function r(s){if(e[s])return e[s].exports;var i=e[s]={exports:{}};return t[s](i,i.exports,r),i.exports}return r.d=(t,e)=>{for(var s in e)r.o(e,s)&&!r.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r(423)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9Od3NBcGkvLi9zcmMvanMvQmFzZS5qcyIsIndlYnBhY2s6Ly9Od3NBcGkvLi9zcmMvanMvQWxlcnQuanMiLCJ3ZWJwYWNrOi8vTndzQXBpLy4vc3JjL2pzL0ZvcmVjYXN0LmpzIiwid2VicGFjazovL053c0FwaS8uL3NyYy9qcy9Qcm9kdWN0LmpzIiwid2VicGFjazovL053c0FwaS93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9Od3NBcGkvd2VicGFjay9zdGFydHVwIiwid2VicGFjazovL053c0FwaS93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vTndzQXBpL3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vTndzQXBpL3dlYnBhY2svcnVudGltZS9tYWtlIG5hbWVzcGFjZSBvYmplY3QiXSwibmFtZXMiOlsiQmFzZSIsInVybCIsIm9wdGlvbnMiLCJ3YWl0IiwibnVtVHJpZXMiLCJyZXNwb25zZSIsImZldGNoIiwib2siLCJFcnJvciIsInN0YXR1c1RleHQiLCJlcnIiLCJ0aGlzIiwic2xlZXAiLCJyZXRyeUZldGNoIiwidXJscyIsIlByb21pc2UiLCJhbGwiLCJtYXAiLCJhc3luYyIsImpzb24iLCJtcyIsInJlc29sdmUiLCJzZXRUaW1lb3V0IiwiYmFzZVVybCIsInBhcmFtZXRlcnMiLCJrIiwidiIsIk9iamVjdCIsImVudHJpZXMiLCJwYXJtIiwidmFsIiwiQXJyYXkiLCJpc0FycmF5Iiwiam9pbiIsInRvU3RyaW5nIiwiZW5jb2RlVVJJIiwiQWxlcnQiLCJmaWx0ZXJzIiwic3VwZXIiLCJfcXVlcnlVcmwiLCJfcmVxdWVzdFJldHJ5TGltaXQiLCJfcmVxdWVzdFJldHJ5VGltZW91dCIsIl9maWx0ZXJzIiwiYWN0aXZlIiwic3RhcnQiLCJlbmQiLCJzdGF0dXMiLCJtZXNzYWdlX3R5cGUiLCJldmVudCIsImNvZGUiLCJyZWdpb25fdHlwZSIsInBvaW50IiwicmVnaW9uIiwiYXJlYSIsInpvbmUiLCJ1cmdlbmN5IiwiY2VydGFpbnR5Iiwic2V2ZXJpdHkiLCJsaW1pdCIsImN1cnNvciIsInByb2R1Y3QiLCJzaXRlaWQiLCJjb3VudHkiLCJsYXRsb24iLCJuZXdwcm9wIiwicmV0dXJuT2JqIiwidXBkYXRlZCIsImZlYXR1cmVzIiwiYXNzaWduIiwiY2FsbGJhY2siLCJhcmdzIiwiYnVpbGRHZXRVcmwiLCJEYXRlIiwiY29uc29sZSIsImVycm9yIiwiRm9yZWNhc3QiLCJsYXQiLCJsb24iLCJfYmFzZVVybCIsIl9wb2ludHNVcmwiLCJfZ3JpZHBvaW50c1VybCIsIl9mY3N0SG91cmx5VXJsIiwiX2Zjc3RTdW1tYXJ5VXJsIiwiX2xhdCIsIl9sb24iLCJfbWV0YURhdGEiLCJfcmF3Rm9yZWNhc3QiLCJfc3VtbWFyeUZvcmVjYXN0IiwiX2hvdXJseUZvcmVjYXN0IiwicXVlcnlSYXdGb3JlY2FzdCIsInF1ZXJ5SG91cmx5Rm9yZWNhc3QiLCJxdWVyeVN1bW1hcnlGb3JlY2FzdCIsInF1ZXJ5UG9pbnRNZXRhZGF0YSIsInByb3BlcnRpZXMiLCJncmlkWCIsImdyaWRZIiwiY3dhIiwidHlwZXMiLCJmb3JlY2FzdERhdGEiLCJpbmNsdWRlcyIsImdldFJhd0ZvcmVjYXN0IiwiZ2V0SG91cmx5Rm9yZWNhc3QiLCJnZXRTdW1tYXJ5Rm9yZWNhc3QiLCJlbGVtZW50Iiwic3RhcnREYXRlIiwiZW5kRGF0ZSIsInJhd0Zjc3REYXRhIiwidmFsdWVzIiwiaG91cmx5RmNzdERhdGEiLCJ2YWxpZEhvdXJseUZjc3REYXRhIiwiY2FsY01ldGhvZCIsImZvckVhY2giLCJyYXdGY3N0IiwiY29uY2F0IiwiaG91cmx5Rm9yZWNhc3RGcm9tUmF3IiwiZmlsdGVyIiwiZmNzdCIsIlByb2R1Y3QiLCJfZ2V0TW9zdFJlY2VudExpbWl0IiwiX2dldEFsbExpbWl0IiwibG9jYXRpb24iLCJvZmZpY2UiLCJ3bW9pZCIsInR5cGUiLCJfcHJvZHVjdExpc3RpbmciLCJudW1Qcm9kdWN0cyIsIl9tb3N0UmVjZW50TGltaXQiLCJnZXRGdWxsUHJvZHVjdExpc3RpbmciLCJwcm9kTGlzdGluZ1N1YnNldCIsInNsaWNlIiwicHJvZEZ1bGxUZXh0cyIsImdldFByb2R1Y3RzRnVsbHRleHQiLCJsZW5ndGgiLCJnZXRNdWx0aXBsZVByb2R1Y3RzRnVsbHRleHQiLCJwcm9kdWN0TGlzdGluZyIsInByb2R1Y3RUZXh0cyIsInByb2QiLCJyZXRyeUZldGNoQWxsSnNvbiIsImxvZyIsIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJfX3dlYnBhY2tfbW9kdWxlc19fIiwiZCIsImRlZmluaXRpb24iLCJrZXkiLCJvIiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0Iiwib2JqIiwicHJvcCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIl0sIm1hcHBpbmdzIjoiK0dBQ2UsTUFBTUEsRUFDcEIsZUFJQSxpQkFBaUJDLEVBQUtDLEVBQVNDLEVBQU1DLEdBQ2xDLElBQ0QsSUFBSUMsUUFBaUJDLE1BQU1MLEVBQUtDLEdBQ2hDLEdBQUtHLEVBQVNFLEdBQ0osT0FBT0YsRUFERyxNQUFNLElBQUlHLE1BQU0sY0FBY1AsRUFBSSxZQUFjSSxFQUFTSSxZQUUxRSxNQUFNQyxHQUNULEdBQWlCLElBQWJOLEVBQWtCLE1BQU1NLEVBRzNCLGFBRE1DLEtBQUtDLE1BQU1ULFNBQ0pRLEtBQUtFLFdBQVdaLEVBQUtDLEVBQVNDLEVBQU1DLEVBQVcsSUFLL0Qsd0JBQXdCVSxFQUFLWixFQUFRQyxFQUFLQyxHQUN6QyxhQUFhVyxRQUFRQyxJQUNwQkYsRUFBS0csS0FBSUMsZ0JBQ2VQLEtBQUtFLFdBQVdaLEVBQUlDLEVBQVFDLEVBQUtDLElBQ3hDZSxVQU1uQixZQUFZQyxHQUNWLE9BQU8sSUFBSUwsU0FBUU0sR0FB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SCxrQkFBa0IzSCxFQUFNLEtBQU1ILEtBQUs4QixxQkFBc0I5QixLQUFLNkIsb0JBR3pGLE9BREFpQyxRQUFRaUUsSUFBSUgsR0FDTEEsTUNuRkxJLEVBQTJCLEdBRy9CLFNBQVNDLEVBQW9CQyxHQUU1QixHQUFHRixFQUF5QkUsR0FDM0IsT0FBT0YsRUFBeUJFLEdBQVVDLFFBRzNDLElBQUlDLEVBQVNKLEVBQXlCRSxHQUFZLENBR2pEQyxRQUFTLElBT1YsT0FIQUUsRUFBb0JILEdBQVVFLEVBQVFBLEVBQU9ELFFBQVNGLEdBRy9DRyxFQUFPRCxRQ2pCZixPQ0ZBRixFQUFvQkssRUFBSSxDQUFDSCxFQUFTSSxLQUNqQyxJQUFJLElBQUlDLEtBQU9ELEVBQ1hOLEVBQW9CUSxFQUFFRixFQUFZQyxLQUFTUCxFQUFvQlEsRUFBRU4sRUFBU0ssSUFDNUV4SCxPQUFPMEgsZUFBZVAsRUFBU0ssRUFBSyxDQUFFRyxZQUFZLEVBQU1DLElBQUtMLEVBQVdDLE1DSjNFUCxFQUFvQlEsRUFBSSxDQUFDSSxFQUFLQyxJQUFTOUgsT0FBTytILFVBQVVDLGVBQWVDLEtBQUtKLEVBQUtDLEdDQ2pGYixFQUFvQmlCLEVBQUtmLElBQ0gsb0JBQVhnQixRQUEwQkEsT0FBT0MsYUFDMUNwSSxPQUFPMEgsZUFBZVAsRUFBU2dCLE9BQU9DLFlBQWEsQ0FBRUMsTUFBTyxXQUU3RHJJLE9BQU8wSCxlQUFlUCxFQUFTLGFBQWMsQ0FBRWtCLE9BQU8sS0hGaERwQixFQUFvQixNIiwiZmlsZSI6Ik53c0FwaS5qcyIsInNvdXJjZXNDb250ZW50IjpbIlxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQmFzZSB7IFxuXHRjb25zdHJ1Y3Rvcigpe1xuXHR9XG5cbiAgLy9yZXRyeXMgYSBwcm9taXNlIG11bHRpcGxlIHRpbWVzIHdpdGggYSB0aW1lb3V0IGluIG9yZGVyIHRvIGRlYWwgd2l0aCBmYWlsZWQgcmVxdWVzdHMuXG5cdGFzeW5jIHJldHJ5RmV0Y2godXJsLCBvcHRpb25zLCB3YWl0LCBudW1Ucmllcykge1xuICAgIHRyeSB7XG5cdFx0XHRsZXQgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwsIG9wdGlvbnMpO1xuXHRcdFx0aWYgKCFyZXNwb25zZS5vaykgeyB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVlc3QgdG8gJyt1cmwrJyBmYWlsZWQ6ICcgKyByZXNwb25zZS5zdGF0dXNUZXh0KTsgfVxuICAgICAgZWxzZSB7IHJldHVybiByZXNwb25zZTsgfVxuICAgIH0gY2F0Y2goZXJyKSB7XG5cdFx0XHRpZiAobnVtVHJpZXMgPT09IDEpIHsgdGhyb3cgZXJyOyB9XG5cdFx0XHRlbHNlIHsgXG5cdFx0XHRcdGF3YWl0IHRoaXMuc2xlZXAod2FpdCk7XG5cdFx0XHRcdHJldHVybiBhd2FpdCB0aGlzLnJldHJ5RmV0Y2godXJsLCBvcHRpb25zLCB3YWl0LCBudW1UcmllcyAtIDEpO1x0XG5cdFx0XHR9XG4gICAgfVxuXHR9O1xuXG5cdGFzeW5jIHJldHJ5RmV0Y2hBbGxKc29uKHVybHMsb3B0aW9ucyx3YWl0LG51bVRyaWVzKSB7IFxuXHRcdHJldHVybiBhd2FpdCBQcm9taXNlLmFsbChcblx0XHRcdHVybHMubWFwKGFzeW5jIHVybCA9PiB7XG5cdFx0XHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5yZXRyeUZldGNoKHVybCxvcHRpb25zLHdhaXQsbnVtVHJpZXMpO1xuXHRcdFx0XHRyZXR1cm4gcmVzcG9uc2UuanNvbigpO1xuXHRcdFx0fSlcblx0XHQpXG5cdH1cblxuXG5cdGFzeW5jIHNsZWVwKG1zKSB7XG4gIFx0cmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCBtcykpO1xuXHR9O1xuXG5cbiAgLy9CdWlsZCBVUkwgZnJvbSBhbGwgcGFyYW1ldGVyc1xuICBidWlsZEdldFVybChiYXNlVXJsLCBwYXJhbWV0ZXJzKSB7XG5cdFx0Ly9PYmplY3QuZW50cmllcyhvYmopLnNvcnQoKGEsIGIpID0+IGJbMF0ubG9jYWxlQ29tcGFyZShhWzBdKSk7XG5cdFx0bGV0IHVybCA9IGJhc2VVcmwrJz8nO1xuICBcdGZvciAobGV0IFtrLCB2XSBvZiBPYmplY3QuZW50cmllcyhwYXJhbWV0ZXJzKSkge1xuXHQgICAgaWYgKHYgIT09IG51bGwpIHtcbiAgICAgIFx0bGV0IHBhcm0gPSBrO1xuICAgICAgXHRsZXQgdmFsID0gJyc7XG4gICAgICBcdGlmIChBcnJheS5pc0FycmF5KHYpKSB7IHZhbCA9IHYuam9pbignLCcpOyB9XG4gICAgICBcdGVsc2UgeyB2YWwgPSB2LnRvU3RyaW5nKCk7IH1cbiAgICAgIFx0dXJsICs9ICcmJyArIHBhcm0gKyAnPScgKyB2YWw7XG4gICAgXHR9XG5cdFx0fVxuXHRcdHVybCA9IGVuY29kZVVSSSh1cmwpO1xuXHRcdHJldHVybiB1cmw7XG5cdH1cdFxuXG5cblxufSIsImltcG9ydCBCYXNlIGZyb20gJy4vQmFzZS5qcyc7XG5cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQWxlcnQgZXh0ZW5kcyBCYXNlICB7XG5cdFxuXHRjb25zdHJ1Y3RvcihmaWx0ZXJzLG9wdGlvbnMpIHtcblx0XHRzdXBlcigpO1xuXHRcdHRoaXMuX3F1ZXJ5VXJsID0gJ2h0dHBzOi8vYXBpLndlYXRoZXIuZ292L2FsZXJ0cyc7XG5cdFx0Ly90aGlzLl9hY3RpdmVVcmwgPSAnL2FjdGl2ZSdcblx0XHQvL3RoaXMuX3pvbmVVcmwgPSAnL3pvbmUnO1xuXHRcdHRoaXMuX3JlcXVlc3RSZXRyeUxpbWl0ID0gNDtcblx0XHR0aGlzLl9yZXF1ZXN0UmV0cnlUaW1lb3V0ID0gNDAwMDsgLy80MDAwO1xuXHRcdHRoaXMuX2ZpbHRlcnMgPSB7XG5cdFx0XHRhY3RpdmUgOiBudWxsLFxuXHRcdFx0c3RhcnQgOiBudWxsLFxuXHRcdFx0ZW5kIDogbnVsbCxcblx0XHRcdHN0YXR1cyA6IG51bGwsXG5cdFx0XHRtZXNzYWdlX3R5cGUgOiBudWxsLFxuXHRcdFx0ZXZlbnQgOiBudWxsLFxuXHRcdFx0Y29kZSA6IG51bGwsXG5cdFx0XHRyZWdpb25fdHlwZSA6IG51bGwsXG5cdFx0XHRwb2ludCA6IG51bGwsXG5cdFx0XHRyZWdpb24gOiBudWxsLFxuXHRcdFx0YXJlYSA6IG51bGwsXG5cdFx0XHR6b25lIDogbnVsbCxcblx0XHRcdHVyZ2VuY3kgOiBudWxsLFxuXHRcdFx0Y2VydGFpbnR5IDogbnVsbCxcblx0XHRcdHNldmVyaXR5IDogbnVsbCxcblx0XHRcdGxpbWl0IDogbnVsbCxcblx0XHRcdGN1cnNvciA6IG51bGwsXG5cdFx0XHRwcm9kdWN0IDogbnVsbCxcblx0XHRcdHNpdGVpZCA6IG51bGwsXG5cdFx0XHR6b25lIDogbnVsbCxcblx0XHRcdGNvdW50eSA6IG51bGwsICBcblx0XHRcdGxhdGxvbiA6IG51bGwsXG5cdFx0XHRuZXdwcm9wIDogbnVsbCxcblx0XHR9XG5cdFx0dGhpcy5yZXR1cm5PYmogPSB7XG5cdFx0XHR1cGRhdGVkIDogbnVsbCxcblx0XHRcdGZlYXR1cmVzIDogbnVsbFxuXHRcdH1cblx0XHR0aGlzLl9maWx0ZXJzID0gT2JqZWN0LmFzc2lnbih0aGlzLl9maWx0ZXJzLCBmaWx0ZXJzKTsgICAvLyBDb3VsZCBhbHNvIGp1c3QgZG8gXCJhZGRlZEJhY2suY29tbWVudHMgPSBDb21tZW50cy5jb21tZW50cztcIiBpZiB5b3Ugb25seSBjYXJlIGFib3V0IHRoaXMgb25lIHByb3BlcnR5XG5cdH07XG5cblx0YXN5bmMgZ2V0QWxsKGNhbGxiYWNrLC4uLmFyZ3Mpe1xuXHRcdGxldCB1cmwgPSB0aGlzLmJ1aWxkR2V0VXJsKHRoaXMuX3F1ZXJ5VXJsLHRoaXMuX2ZpbHRlcnMpO1xuXG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5yZXRyeUZldGNoKHVybCwgbnVsbCwgdGhpcy5fcmVxdWVzdFJldHJ5VGltZW91dCwgdGhpcy5fcmVxdWVzdFJldHJ5TGltaXQpO1xuXHRcdFx0bGV0IGpzb24gPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cdFx0XHR0aGlzLnJldHVybk9iai51cGRhdGVkID0gbmV3IERhdGUoanNvbi51cGRhdGVkKTtcblx0XHRcdHRoaXMucmV0dXJuT2JqLmZlYXR1cmVzID0ganNvbi5mZWF0dXJlcztcblxuXHRcdFx0Ly9pZiAodGhpcy5fcGlsICE9PSBudWxsKSB7IGpzb24gPSBhd2FpdCB0aGlzLmJ5UGlsKCkgfVx0XHRcblx0XHR9IFxuXHRcdGNhdGNoIHtcblx0XHRcdGNvbnNvbGUuZXJyb3IoJ05XUyBBUEkgVW5hdmFpbGFibGUgb3IgQmFkIFJlcXVlc3Q6ICcgKyB1cmwpOyBcblx0XHRcdHRoaXMucmV0dXJuT2JqID0gZmFsc2U7XG5cdFx0fVxuXG5cdFx0aWYgKGNhbGxiYWNrKSB7IGNhbGxiYWNrKHRoaXMucmV0dXJuT2JqLC4uLmFyZ3MpOyB9XG5cdFx0ZWxzZSB7IHJldHVybiB0aGlzLnJldHVybk9iajsgfVx0XHRcdFxuXHR9O1xuXG59XG4iLCJpbXBvcnQgQmFzZSBmcm9tICcuL0Jhc2UuanMnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JlY2FzdCBleHRlbmRzIEJhc2UgIHtcblx0Y29uc3RydWN0b3IobGF0LGxvbikge1xuXHRcdHN1cGVyKCk7XG5cdFx0dGhpcy5fYmFzZVVybCA9ICdodHRwczovL2FwaS53ZWF0aGVyLmdvdi8nO1xuXHRcdHRoaXMuX3BvaW50c1VybCA9ICdwb2ludHMvJztcblx0XHR0aGlzLl9ncmlkcG9pbnRzVXJsID0gJ2dyaWRwb2ludHMvJztcblx0XHR0aGlzLl9mY3N0SG91cmx5VXJsID0gJ2ZvcmVjYXN0L2hvdXJseSc7XG5cdFx0dGhpcy5fZmNzdFN1bW1hcnlVcmwgPSAnZm9yZWNhc3QnO1xuXG5cdFx0dGhpcy5fcmVxdWVzdFJldHJ5TGltaXQgPSA0O1xuXHRcdHRoaXMuX3JlcXVlc3RSZXRyeVRpbWVvdXQgPSA0MDAwOyBcblx0XHR0aGlzLl9sYXQgPSBsYXQ7XG5cdFx0dGhpcy5fbG9uID0gbG9uO1xuXG5cdFx0dGhpcy5fbWV0YURhdGEgPSBudWxsO1xuXHRcdHRoaXMuX3Jhd0ZvcmVjYXN0ID0gbnVsbDtcblx0XHR0aGlzLl9zdW1tYXJ5Rm9yZWNhc3QgPSBudWxsO1xuXHRcdHRoaXMuX2hvdXJseUZvcmVjYXN0ID0gbnVsbDtcblx0fVxuXG5cdGFzeW5jIGdldFJhd0ZvcmVjYXN0KGNhbGxiYWNrLC4uLmFyZ3Mpe1xuXHRcdGlmICghdGhpcy5fcmF3Rm9yZWNhc3QpeyBhd2FpdCB0aGlzLnF1ZXJ5UmF3Rm9yZWNhc3QoKTsgfVxuXHRcdGlmIChjYWxsYmFjaykgIHsgY2FsbGJhY2soanNvbiwuLi5hcmdzKTsgfVxuXHRcdGVsc2UgeyByZXR1cm4gdGhpcy5fcmF3Rm9yZWNhc3Q7IH1cblx0fVxuXHRhc3luYyBnZXRIb3VybHlGb3JlY2FzdChjYWxsYmFjaywuLi5hcmdzKXtcblx0XHRpZiAoIXRoaXMuX2hvdXJseUZvcmVjYXN0KXsgYXdhaXQgdGhpcy5xdWVyeUhvdXJseUZvcmVjYXN0KCk7IH1cblx0XHRpZiAoY2FsbGJhY2spICB7IGNhbGxiYWNrKGpzb24sLi4uYXJncyk7IH1cblx0XHRlbHNlIHsgcmV0dXJuIHRoaXMuX2hvdXJseUZvcmVjYXN0OyB9XG5cdH1cblx0YXN5bmMgZ2V0U3VtbWFyeUZvcmVjYXN0KGNhbGxiYWNrLC4uLmFyZ3Mpe1xuXHRcdGlmICghdGhpcy5fc3VtbWFyeUZvcmVjYXN0KXsgYXdhaXQgdGhpcy5xdWVyeVN1bW1hcnlGb3JlY2FzdCgpOyB9XG5cdFx0aWYgKGNhbGxiYWNrKSAgeyBjYWxsYmFjayhqc29uLC4uLmFyZ3MpOyB9XG5cdFx0ZWxzZSB7IHJldHVybiB0aGlzLl9zdW1tYXJ5Rm9yZWNhc3Q7IH1cblx0fVxuXHRhc3luYyBnZXRNZXRhRGF0YSgpe1xuXHRcdGlmICghdGhpcy5fbWV0YURhdGEpeyBhd2FpdCB0aGlzLnF1ZXJ5UG9pbnRNZXRhZGF0YSgpO1x0fVxuXHRcdHJldHVybiB0aGlzLl9tZXRhRGF0YTsgXG5cdH1cblx0XG5cdGdldCBncmlkWCgpIHsgcmV0dXJuIHRoaXMuX21ldGFEYXRhLnByb3BlcnRpZXMuZ3JpZFg7IH1cblx0Z2V0IGdyaWRZKCkgeyByZXR1cm4gdGhpcy5fbWV0YURhdGEucHJvcGVydGllcy5ncmlkWTsgfVxuXHRnZXQgY3dhKCkgeyByZXR1cm4gdGhpcy5fbWV0YURhdGEucHJvcGVydGllcy5jd2E7IH1cblxuXHRhc3luYyBxdWVyeVBvaW50TWV0YWRhdGEoKSB7XG5cdFx0dmFyIHNlbGYgPSB0aGlzO1xuXHRcdHZhciB1cmwgPSB0aGlzLl9iYXNlVXJsK3RoaXMuX3BvaW50c1VybCt0aGlzLl9sYXQrJywnK3RoaXMuX2xvbjtcblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMucmV0cnlGZXRjaCh1cmwpO1xuXHRcdHRoaXMuX21ldGFEYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXHR9O1xuXHRhc3luYyBxdWVyeVJhd0ZvcmVjYXN0KGNhbGxiYWNrLC4uLmFyZ3MpIHtcblx0XHRpZiAoIXRoaXMuX21ldGFEYXRhKXsgYXdhaXQgdGhpcy5xdWVyeVBvaW50TWV0YWRhdGEoKTtcdH1cblx0XHR2YXIgdXJsID0gdGhpcy5fYmFzZVVybCt0aGlzLl9ncmlkcG9pbnRzVXJsK3RoaXMuY3dhKycvJyt0aGlzLmdyaWRYKycsJyt0aGlzLmdyaWRZXG5cdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLnJldHJ5RmV0Y2godXJsKVxuXHRcdGNvbnN0IGpzb24gPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cdFx0dGhpcy5fcmF3Rm9yZWNhc3QgPSBqc29uIFxuXHR9XG5cdGFzeW5jIHF1ZXJ5SG91cmx5Rm9yZWNhc3QoY2FsbGJhY2ssLi4uYXJncykge1xuXHRcdGlmICghdGhpcy5fbWV0YURhdGEpeyBhd2FpdCB0aGlzLnF1ZXJ5UG9pbnRNZXRhZGF0YSgpO1x0fVxuXHRcdHZhciB1cmwgPSB0aGlzLl9iYXNlVXJsK3RoaXMuX2dyaWRwb2ludHNVcmwrdGhpcy5jd2ErJy8nK3RoaXMuZ3JpZFgrJywnK3RoaXMuZ3JpZFkrJy8nK3RoaXMuX2Zjc3RIb3VybHlVcmw7XG5cdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLnJldHJ5RmV0Y2godXJsKVxuXHRcdGNvbnN0IGpzb24gPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cdFx0dGhpcy5faG91cmx5Rm9yZWNhc3QgPSBqc29uIFxuXHR9XG5cdGFzeW5jIHF1ZXJ5U3VtbWFyeUZvcmVjYXN0KGNhbGxiYWNrLC4uLmFyZ3MpIHtcblx0XHRpZiAoIXRoaXMuX21ldGFEYXRhKXsgYXdhaXQgdGhpcy5xdWVyeVBvaW50TWV0YWRhdGEoKTtcdH1cblx0XHR2YXIgdXJsID0gdGhpcy5fYmFzZVVybCt0aGlzLl9ncmlkcG9pbnRzVXJsK3RoaXMuY3dhKycvJyt0aGlzLmdyaWRYKycsJyt0aGlzLmdyaWRZKycvJyt0aGlzLl9mY3N0U3VtbWFyeVVybDtcblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMucmV0cnlGZXRjaCh1cmwpXG5cdFx0Y29uc3QganNvbiA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblx0XHR0aGlzLl9zdW1tYXJ5Rm9yZWNhc3QgPSBqc29uIFxuXHR9XG5cdGFzeW5jIGdldEZvcmVjYXN0cyh0eXBlcyxjYWxsYmFjaywuLi5hcmdzKSB7XG5cdFx0bGV0IGZvcmVjYXN0RGF0YSA9IHt9XG5cdFx0aWYgKHR5cGVzLmluY2x1ZGVzKCdyYXcnKSkgeyBmb3JlY2FzdERhdGFbJ3JhdyddID0gYXdhaXQgdGhpcy5nZXRSYXdGb3JlY2FzdCgpOyB9XG5cdFx0aWYgKHR5cGVzLmluY2x1ZGVzKCdob3VybHknKSkgeyBmb3JlY2FzdERhdGFbJ2hvdXJseSddID0gYXdhaXQgdGhpcy5nZXRIb3VybHlGb3JlY2FzdCgpOyB9XG5cdFx0aWYgKHR5cGVzLmluY2x1ZGVzKCdzdW1tYXJ5JykpIHsgZm9yZWNhc3REYXRhWydzdW1tYXJ5J10gPSBhd2FpdCB0aGlzLmdldFN1bW1hcnlGb3JlY2FzdCgpOyB9XG5cdFx0aWYgKGNhbGxiYWNrKSAgeyBjYWxsYmFjayhmb3JlY2FzdERhdGEsLi4uYXJncyk7IH1cblx0XHRlbHNlIHsgcmV0dXJuIGZvcmVjYXN0RGF0YSB9XG5cdH1cblxuXHRhc3luYyBnZXRSYXdXZWF0aGVyRGF0YUJldHdlZW5QZXJpb2RzKGVsZW1lbnQsc3RhcnREYXRlLGVuZERhdGUpe1xuXHRcdGlmICghdGhpcy5fcmF3Rm9yZWNhc3QpeyBhd2FpdCB0aGlzLmdldFJhd0ZvcmVjYXN0KCk7XHR9XG5cdFx0bGV0IHJhd0Zjc3REYXRhID0gdGhpcy5fcmF3Rm9yZWNhc3QucHJvcGVydGllc1tlbGVtZW50XS52YWx1ZXM7XG5cdFx0bGV0IGhvdXJseUZjc3REYXRhID0gW107XG5cdFx0bGV0IHZhbGlkSG91cmx5RmNzdERhdGEgPSBbXTtcblx0XHRsZXQgY2FsY01ldGhvZCA9IGZhbHNlO1xuXHRcdGlmIChlbGVtZW50ID09ICdxdWFudGl0YXRpdmVQcmVjaXBpdGF0aW9uJykgeyBjYWxjTWV0aG9kID0gJ3NwbGl0JzsgfVxuXHRcdHJhd0Zjc3REYXRhLmZvckVhY2goIHJhd0Zjc3QgPT4ge1xuXHRcdFx0XG5cdFx0XHRob3VybHlGY3N0RGF0YSA9IGhvdXJseUZjc3REYXRhLmNvbmNhdCh0aGlzLmhvdXJseUZvcmVjYXN0RnJvbVJhdyhyYXdGY3N0LGNhbGNNZXRob2QpKTtcblx0XHR9KTtcblx0XHRcblx0XHR2YWxpZEhvdXJseUZjc3REYXRhID0gaG91cmx5RmNzdERhdGEuZmlsdGVyKChmY3N0KSA9PiB7XG5cdFx0XHRpZiAoKGZjc3Quc3RhcnREYXRlID49IHN0YXJ0RGF0ZSkgJiYgKGZjc3QuZW5kRGF0ZSA8PSBlbmREYXRlKSkgeyByZXR1cm4gdHJ1ZTsgfVxuXHRcdH0pXG5cdFx0cmV0dXJuIHZhbGlkSG91cmx5RmNzdERhdGE7XG5cdH1cblx0XG4vKlx0aG91cmx5VGltZXNCZXR3ZWVuKHN0YXJ0RGF0ZSxlbmREYXRlKXtcblx0XHRsZXQgZGVzaXJlZEZvcmVjYXN0RGF0ZXMgPSBbXTtcblx0XHRsZXQgaG91cmx5RGF0ZSA9IHN0YXJ0RGF0ZTsgXG5cdFx0d2hpbGUgKGhvdXJseURhdGUgPCBlbmREYXRlKXtcblx0XHRcdGRlc2lyZWRGb3JlY2FzdERhdGVzLnB1c2gobmV3IERhdGUoaG91cmx5RGF0ZSkpXG5cdFx0XHRob3VybHlEYXRlID0gbmV3IERhdGUoaG91cmx5RGF0ZS5zZXRIb3Vycyhob3VybHlEYXRlLmdldEhvdXJzKCkgKyAxKSk7XG5cdFx0fVxuXHRcdHJldHVybiBkZXNpcmVkRm9yZWNhc3REYXRlcztcblx0fSovXG5cbi8qXHRob3VybHlGb3JlY2FzdEZyb21SYXcod3hEYXRhLGNhbGMpe1xuXHRcdGxldCB3eERhdGFUaW1lUGVyaW9kID0gdGhpcy5kZWNvZGVSYXdGb3JlY2FzdFRpbWVQZXJpb2Qod3hEYXRhLnZhbGlkVGltZSlcblx0XHRsZXQgaG91cmx5Rm9yZWNhc3REYXRhID0gW107XG5cdFx0bGV0IGhvdXJseURhdGUgPSB3eERhdGFUaW1lUGVyaW9kLnN0YXJ0RGF0ZTtcblx0XHRsZXQgaG91cmx5VmFsdWU7XG5cdFx0aWYgKGNhbGMgPT0gJ3NwbGl0JykgeyBob3VybHlWYWx1ZSA9IHd4RGF0YS52YWx1ZSAvIHd4RGF0YVRpbWVQZXJpb2QuZHVyYXRpb247IH1cblx0XHRlbHNlIHsgaG91cmx5VmFsdWUgPSB3eERhdGEudmFsdWU7IH1cblx0XHR3aGlsZSAoaG91cmx5RGF0ZSA8IHd4RGF0YVRpbWVQZXJpb2QuZW5kRGF0ZSl7XG5cdFx0XHRsZXQgaG91cmx5U3RhcnREYXRlID0gbmV3IERhdGUoaG91cmx5RGF0ZSk7XG5cdFx0XHRob3VybHlEYXRlID0gbmV3IERhdGUoaG91cmx5RGF0ZS5zZXRIb3Vycyhob3VybHlEYXRlLmdldEhvdXJzKCkgKyAxKSlcblx0XHRcdGxldCBob3VybHlFbmREYXRlID0gbmV3IERhdGUoaG91cmx5RGF0ZSk7IFxuXHRcdFx0aG91cmx5Rm9yZWNhc3REYXRhLnB1c2goe1xuXHRcdFx0XHRzdGFydERhdGUgOiBob3VybHlTdGFydERhdGUsXG5cdFx0XHRcdGVuZERhdGUgOiBob3VybHlFbmREYXRlLFxuXHRcdFx0XHR2YWx1ZSA6IGhvdXJseVZhbHVlXG5cdFx0XHR9KVxuXHRcdH1cblx0XHRyZXR1cm4gaG91cmx5Rm9yZWNhc3REYXRhO1xuXHR9XG5cdFxuXG5cdGRlY29kZVJhd0ZvcmVjYXN0VGltZVBlcmlvZCh2YWxpZFRpbWUpe1xuXHRcdGxldCBzdGFydCA9IHZhbGlkVGltZS5zcGxpdCgnLycpWzBdO1xuXHRcdGxldCBkdXJhdGlvbiA9IHZhbGlkVGltZS5zcGxpdCgnLycpWzFdO1xuXHRcdGR1cmF0aW9uID0gcGFyc2VJbnQoZHVyYXRpb24uc3Vic3RyaW5nKGR1cmF0aW9uLmxhc3RJbmRleE9mKFwiVFwiKSArIDEsZHVyYXRpb24ubGFzdEluZGV4T2YoXCJIXCIpKSlcblx0XHRsZXQgc3RhcnREYXRlID0gbmV3IERhdGUoc3RhcnQpO1xuXHRcdGxldCBlbmREYXRlID0gbmV3IERhdGUoc3RhcnQpO1xuXHRcdGVuZERhdGUuc2V0SG91cnMoZW5kRGF0ZS5nZXRIb3VycygpK2R1cmF0aW9uKTtcblx0XHRyZXR1cm4ge1wic3RhcnREYXRlXCI6IHN0YXJ0RGF0ZSwgXCJlbmREYXRlXCI6IGVuZERhdGUsIFwiZHVyYXRpb25cIjogZHVyYXRpb24gfTtcblx0fSovXG5cblxuXG5cdFxuLy9cdFx0Y29uc3Qgc3VtbWFyeUZjc3QgPSBhd2FpdCB0aGlzLnN1bW1hcmh5Rm9yZWNhc3QoKTtcbi8vXHRcdGlmICghdGhpcy5fbWV0YURhdGEpeyBhd2FpdCB0aGlzLmFwaVBvaW50TWV0YURhdGEoKTtcdH1cbi8vXHRcdHZhciB1cmwgPSB0aGlzLl9iYXNlVXJsK3RoaXMuX2dyaWRwb2ludHNVcmwrdGhpcy5fY3dhKycvJyt0aGlzLl9ncmlkWCsnLCcrdGhpcy5fZ3JpZFkrJy8nK3RoaXMuX2Zjc3RTdW1tYXJ5VXJsO1xuLy9cdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwpXG4vL1x0XHRjb25zdCBqc29uID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuLy9cdFx0Y2FsbGJhY2soanNvbiwuLi5hcmdzKVxuLy9cdH1cblxufSIsImltcG9ydCBCYXNlIGZyb20gJy4vQmFzZS5qcyc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFByb2R1Y3QgZXh0ZW5kcyBCYXNlICB7XG5cdFxuXHRjb25zdHJ1Y3RvcihmaWx0ZXJzLG9wdGlvbnMpIHtcblx0XHRzdXBlcigpO1xuXHRcdHRoaXMuX3F1ZXJ5VXJsID0gJ2h0dHBzOi8vYXBpLndlYXRoZXIuZ292L3Byb2R1Y3RzJztcblx0XHQvL3RoaXMuX2FjdGl2ZVVybCA9ICcvYWN0aXZlJ1xuXHRcdC8vdGhpcy5fem9uZVVybCA9ICcvem9uZSc7XG5cdFx0dGhpcy5fcmVxdWVzdFJldHJ5TGltaXQgPSA0O1xuXHRcdHRoaXMuX3JlcXVlc3RSZXRyeVRpbWVvdXQgPSAxMDAwOyAvLzQwMDA7XG5cdFx0dGhpcy5fZ2V0TW9zdFJlY2VudExpbWl0ID0gNTA7XG5cdFx0dGhpcy5fZ2V0QWxsTGltaXQgPSAyNTA7XG5cdFx0dGhpcy5fZmlsdGVycyA9IHtcblx0XHRcdGxvY2F0aW9uIDogbnVsbCxcblx0XHRcdHN0YXJ0IDogbnVsbCxcblx0XHRcdGVuZCA6IG51bGwsXG5cdFx0XHRvZmZpY2UgOiBudWxsLFxuXHRcdFx0d21vaWQgOiBudWxsLFxuXHRcdFx0dHlwZSA6IG51bGwsXG5cdFx0XHRsaW1pdCA6IG51bGwsXG5cdFx0fVxuXG5cdFx0dGhpcy5fcHJvZHVjdExpc3RpbmcgPSBmYWxzZTtcblxuXHRcdHRoaXMucmV0dXJuT2JqID0ge1xuXHRcdFx0dXBkYXRlZCA6IG51bGwsXG5cdFx0XHRmZWF0dXJlcyA6IG51bGxcblx0XHR9XG5cdFx0dGhpcy5fZmlsdGVycyA9IE9iamVjdC5hc3NpZ24odGhpcy5fZmlsdGVycywgZmlsdGVycyk7ICAgLy8gQ291bGQgYWxzbyBqdXN0IGRvIFwiYWRkZWRCYWNrLmNvbW1lbnRzID0gQ29tbWVudHMuY29tbWVudHM7XCIgaWYgeW91IG9ubHkgY2FyZSBhYm91dCB0aGlzIG9uZSBwcm9wZXJ0eVxuXHR9O1xuXG5cblx0YXN5bmMgZ2V0RnVsbFByb2R1Y3RMaXN0aW5nKCl7XG5cdFx0bGV0IHVybCA9IHRoaXMuYnVpbGRHZXRVcmwodGhpcy5fcXVlcnlVcmwsdGhpcy5fZmlsdGVycyk7XG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5yZXRyeUZldGNoKHVybCwgbnVsbCwgdGhpcy5fcmVxdWVzdFJldHJ5VGltZW91dCwgdGhpcy5fcmVxdWVzdFJldHJ5TGltaXQpO1xuXHRcdFx0bGV0IGpzb24gPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cdFx0XHR0aGlzLl9wcm9kdWN0TGlzdGluZyA9IGpzb25bJ0BncmFwaCddO1x0XG5cdFx0XHRyZXR1cm4gdGhpcy5fcHJvZHVjdExpc3Rpbmc7XG5cdFx0fSBcblx0XHRjYXRjaCB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ05XUyBBUEkgVW5hdmFpbGFibGUgb3IgQmFkIFJlcXVlc3Q6ICcgKyB1cmwpOyBcblx0XHRcdC8vdGhpcy5fcHJvZHVjdExpc3RpbmcgPSBmYWxzZTtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cdFx0Ly9pZiAoY2FsbGJhY2spIHsgY2FsbGJhY2sodGhpcy5yZXR1cm5PYmosLi4uYXJncyk7IH1cblx0XHQvL2Vsc2UgeyByZXR1cm4gdGhpcy5yZXR1cm5PYmo7IH1cdFx0XHRcblx0fTtcblxuXHQvL1JldHVybnMgdGhlIG1vc3QgcmVjZW50IHByb2R1Y3RzIGdpdmVuIGEgdG90YWwgbnVtYmVyIHRvIGdvIGJhY2suXG5cdGFzeW5jIGdldE1vc3RSZWNlbnQobnVtUHJvZHVjdHMgPSAxLGNhbGxiYWNrLC4uLmFyZ3Mpe1xuXHRcdC8vTWFrZSBzdXJlIHdlJ3JlIG5vdCByZXF1ZXN0aW5nIG1vcmUgdGhlbiBvdXIgbWF4IG51bWJlciBvZiBwcm9kdWN0cy5cblx0XHRpZiAobnVtUHJvZHVjdHMgPiB0aGlzLl9tb3N0UmVjZW50TGltaXQpIHsgbnVtUHJvZHVjdHMgPSB0aGlzLl9tb3N0UmVjZW50TGltaXQ7IH1cblx0XHRpZiAoIXRoaXMuX3Byb2R1Y3RMaXN0aW5nKSB7IGF3YWl0IHRoaXMuZ2V0RnVsbFByb2R1Y3RMaXN0aW5nKCk7IH1cblx0XHRsZXQgcHJvZExpc3RpbmdTdWJzZXQgPSB0aGlzLl9wcm9kdWN0TGlzdGluZy5zbGljZSgwLG51bVByb2R1Y3RzKTtcblx0XHRsZXQgcHJvZEZ1bGxUZXh0cyA9IGF3YWl0IHRoaXMuZ2V0UHJvZHVjdHNGdWxsdGV4dChwcm9kTGlzdGluZ1N1YnNldCk7XG5cblx0XHRcblx0XHRpZiAoY2FsbGJhY2spICB7IGNhbGxiYWNrKHByb2RGdWxsVGV4dHMsLi4uYXJncyk7IH1cblx0XHRlbHNlIHsgcmV0dXJuIHByb2RGdWxsVGV4dHM7IH1cblx0fVxuXG5cdC8vR2V0IGFsbCBwcm9kdWN0cyBmcm9tIHRoZSBjdXJyZW50IHByb2R1Y3QgbGlzdGluZy4gIE5vdGUgY2F1dGlvbiBoYXMgdG8gYmUgdXNlZCB3aXRoIHRoaXMuXG5cdC8vUGVyaGFwcyBJIG5lZWQgYW5vdGhlciBtYXhpbXVtIG9yIHJhdGUgbGltaXRlciB0byBub3QgYWxsb3cgZm9sa3MgdG8gYWNjaWRldG5hbGx5IHF1ZXJ5IDUwMDAgcHJvZHVjdHM/XG5cdGFzeW5jIGdldEFsbChjYWxsYmFjaywuLi5hcmdzKXtcblx0XHRsZXQgcHJvZExpc3RpbmdTdWJzZXQgPSBbXTtcblx0XHRpZiAoIXRoaXMuX3Byb2R1Y3RMaXN0aW5nKSB7IHByb2RMaXN0aW5nU3Vic2V0ID0gYXdhaXQgdGhpcy5nZXRGdWxsUHJvZHVjdExpc3RpbmcoKTsgfVxuXHRcdGVsc2UgeyBwcm9kTGlzdGluZ1N1YnNldCA9IHRoaXMuX3Byb2R1Y3RMaXN0aW5nOyB9XG5cdFx0aWYgKHByb2RMaXN0aW5nU3Vic2V0Lmxlbmd0aCA+IHRoaXMuX2dldEFsbExpbWl0KSB7IHByb2RMaXN0aW5nU3Vic2V0ID0gcHJvZExpc3RpbmdTdWJzZXQuc2xpY2UoMCx0aGlzLl9nZXRBbGxMaW1pdCk7IH1cblx0XHRcblx0XHRsZXQgcHJvZEZ1bGxUZXh0cyA9IGF3YWl0IHRoaXMuZ2V0TXVsdGlwbGVQcm9kdWN0c0Z1bGx0ZXh0KHByb2RMaXN0aW5nU3Vic2V0KTtcblx0XHRpZiAoY2FsbGJhY2spICB7IGNhbGxiYWNrKHByb2RGdWxsVGV4dHMsLi4uYXJncyk7IH1cblx0XHRlbHNlIHsgcmV0dXJuIHByb2RGdWxsVGV4dHM7IH1cblx0fVxuXHRcblx0Ly9HZXQgYW4gYXJyYXkgb2YgYWxsIHByb2R1Y3RzIGxpc3RlZCBpbiB0aGUgbGlzdGluZy5cblx0YXN5bmMgZ2V0UHJvZHVjdHNGdWxsdGV4dChwcm9kdWN0TGlzdGluZyl7XG5cdFx0bGV0IHByb2R1Y3RUZXh0cyA9IFtdO1xuXHRcdGlmIChwcm9kdWN0TGlzdGluZy5sZW5ndGggIT09IDApIHtcblx0XHRcdGxldCB1cmxzID0gcHJvZHVjdExpc3RpbmcubWFwKCBwcm9kID0+IHByb2RbJ0BpZCddKTtcdFx0XHRcblx0XHRcdHByb2R1Y3RUZXh0cyA9IGF3YWl0IHRoaXMucmV0cnlGZXRjaEFsbEpzb24odXJscywgbnVsbCwgdGhpcy5fcmVxdWVzdFJldHJ5VGltZW91dCwgdGhpcy5fcmVxdWVzdFJldHJ5TGltaXQpO1xuXHRcdH0gXG5cdFx0Y29uc29sZS5sb2cocHJvZHVjdFRleHRzKTtcblx0XHRyZXR1cm4gcHJvZHVjdFRleHRzO1xuXHR9XG5cblx0Ly9SZXR1cm5zIHRoZSBsYXRlc3QgcHJvZHVjdFxuLypcdGFzeW5jIGdldExhdGVzdChjYWxsYmFjaywuLi5hcmdzKXtcblx0XHR0aGlzLmdldE1vc3RSZWNlbnQoMSxjYWxsYmFjaywuLi5hcmdzKVxuXHR9Ki9cblxuXG5cdFxuLypcdC8vUmV0dXJucyBhbGwgb3IgYSBzdWJzZXQgb2YgdGhlIHByb2R1Y3RzXG5cdGFzeW5jIGJ5U3Vic2V0KGlkeCxjYWxsYmFjaywuLi5hcmdzKXtcblx0XHRsZXQganNvbiA9IFtdO1xuXHRcdGxldCBwcm9kQXJyYXkgPSB0aGlzLl9wcm9kdWN0TGlzdGluZ1snQGdyYXBoJ107XG5cdFx0aWYgKHByb2RBcnJheS5sZW5ndGggIT09IDApIHtcdFxuXHRcdFx0Ly9zbGljZSBvZmYgYW55IGV4dHJhIGlmIGEgbGltaXQgaXMgc2V0LlxuXHRcdFx0aWYgKHRoaXMuX2xpbWl0KSB7IHByb2RBcnJheSA9IHByb2RBcnJheS5zbGljZSgwLHRoaXMuX2xpbWl0ICl9XG5cblx0XHRcdGpzb24gPSBhd2FpdCBQcm9taXNlLmFsbChcblx0XHRcdFx0cHJvZEFycmF5Lm1hcChhc3luYyBwcm9kID0+IHtcblx0XHRcdFx0XHR2YXIgdXJsID0gcHJvZFsnQGlkJ107XG5cdFx0XHRcdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwpXG5cdFx0XHRcdFx0cmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcblx0XHRcdFx0fSlcblx0XHRcdClcblx0XHR9XG5cdFx0aWYgKGNhbGxiYWNrKSAgeyBjYWxsYmFjayhqc29uLC4uLmFyZ3MpOyB9XG5cdFx0ZWxzZSB7IHJldHVybiBqc29uOyB9XG5cdH1cbiovXG59XG5cblxuXG4vKlxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUHJvZHVjdHMge1xuXHRcblx0Y29uc3RydWN0b3IodHlwZSA9IG51bGwsIHdmbyA9IG51bGwsIGlkeCA9IGZhbHNlLCBsaW1pdCA9IGZhbHNlLCBzdGFydERhdGUgPSBmYWxzZSwgZW5kRGF0ZSA9IGZhbHNlKSB7XG5cdFx0dGhpcy5fYmFzZVVybCA9ICdodHRwczovL2FwaS53ZWF0aGVyLmdvdi8nO1xuXHRcdHRoaXMuX3Byb2R1Y3RzVXJsID0gJ3Byb2R1Y3RzJ1xuXHRcdHRoaXMuX2xvY2F0aW9uc1VybCA9ICcvbG9jYXRpb25zJ1xuXHRcdHRoaXMuX3R5cGVzVXJsID0gJy90eXBlcyc7XG5cblx0XHR0aGlzLl90eXBlID0gdHlwZTtcblx0XHR0aGlzLl93Zm8gPSB3Zm87XG5cdFx0dGhpcy5faWR4ID0gaWR4O1xuXHRcdHRoaXMuX2xpbWl0ID0gbGltaXQ7XG5cdFx0dGhpcy5fc3RhcnREYXRlID0gc3RhcnREYXRlO1xuXHRcdHRoaXMuX2VuZERhdGUgPSBlbmREYXRlO1xuXHRcdHRoaXMuX3Byb2R1Y3RMaXN0aW5nID0gbnVsbFxuXHR9XG5cblx0Ly9SZXR1cm5zIGEgc2luZ2xlIHByb2R1Y3QgYnkgYW4gaW5kZXhcblx0YXN5bmMgYnlJbmRleChpZHgsY2FsbGJhY2ssLi4uYXJncyl7XG5cdFx0bGV0IGpzb24gPSB7fTtcblx0XHRpZiAodGhpcy5fcHJvZHVjdExpc3RpbmdbJ0BncmFwaCddLmxlbmd0aCAhPT0gMCkge1xuXHRcdFx0dmFyIHVybCA9IHRoaXMuX3Byb2R1Y3RMaXN0aW5nWydAZ3JhcGgnXVt0aGlzLl9pZHhdWydAaWQnXTtcblx0XHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsKVxuXHRcdFx0anNvbiA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblx0XHR9XG5cdFx0aWYgKGNhbGxiYWNrKSAgeyBjYWxsYmFjayhqc29uLC4uLmFyZ3MpOyB9XG5cdFx0ZWxzZSB7IHJldHVybiBqc29uOyB9XG5cdH1cblxuXHQvL1JldHVybnMgYWxsIG9yIGEgc3Vic2V0IG9mIHRoZSBwcm9kdWN0c1xuXHRhc3luYyBieVN1YnNldChpZHgsY2FsbGJhY2ssLi4uYXJncyl7XG5cdFx0bGV0IGpzb24gPSBbXTtcblx0XHRsZXQgcHJvZEFycmF5ID0gdGhpcy5fcHJvZHVjdExpc3RpbmdbJ0BncmFwaCddO1xuXHRcdGlmIChwcm9kQXJyYXkubGVuZ3RoICE9PSAwKSB7XG5cdFx0XHRcdC8vZmlsdGVyIG91dCBieSBzdGFydCBkYXRlXG5cdFx0XHRpZiAodGhpcy5fc3RhcnREYXRlKSB7IFxuXHRcdFx0XHRwcm9kQXJyYXkgPSBwcm9kQXJyYXkuZmlsdGVyKCBwcm9kdWN0ID0+IHtcblx0XHRcdFx0XHRyZXR1cm4gdGhpcy5fc3RhcnREYXRlIDwgbmV3IERhdGUocHJvZHVjdC5pc3N1YW5jZVRpbWUpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHRcdGlmICh0aGlzLl9lbmREYXRlKSB7IFxuXHRcdFx0XHRwcm9kQXJyYXkgPSBwcm9kQXJyYXkuZmlsdGVyKCBwcm9kdWN0ID0+IHtcblx0XHRcdFx0XHRyZXR1cm4gdGhpcy5fZW5kRGF0ZSA+IG5ldyBEYXRlKHByb2R1Y3QuaXNzdWFuY2VUaW1lKVxuXHRcdFx0XHR9KVxuXHRcdFx0fVx0XHRcdFxuXHRcdFx0Ly9zbGljZSBvZmYgYW55IGV4dHJhIGlmIGEgbGltaXQgaXMgc2V0LlxuXHRcdFx0aWYgKHRoaXMuX2xpbWl0KSB7IHByb2RBcnJheSA9IHByb2RBcnJheS5zbGljZSgwLHRoaXMuX2xpbWl0ICl9XG5cblx0XHRcdGpzb24gPSBhd2FpdCBQcm9taXNlLmFsbChcblx0XHRcdFx0cHJvZEFycmF5Lm1hcChhc3luYyBwcm9kID0+IHtcblx0XHRcdFx0XHR2YXIgdXJsID0gcHJvZFsnQGlkJ107XG5cdFx0XHRcdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwpXG5cdFx0XHRcdFx0cmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcblx0XHRcdFx0fSlcblx0XHRcdClcblx0XHR9XG5cdFx0aWYgKGNhbGxiYWNrKSAgeyBjYWxsYmFjayhqc29uLC4uLmFyZ3MpOyB9XG5cdFx0ZWxzZSB7IHJldHVybiBqc29uOyB9XG5cdH1cblxuXHRhc3luYyBnZXRQcm9kdWN0c0J5TG9jYXRpb25BbmRUeXBlKGNhbGxiYWNrLC4uLmFyZ3Mpe1xuXHRcdGlmICgodGhpcy5fdHlwZSkgJiYgKHRoaXMuX3dmbykpe1xuXHRcdFx0dmFyIHVybCA9IHRoaXMuX2Jhc2VVcmwrdGhpcy5fcHJvZHVjdHNVcmwrdGhpcy5fdHlwZXNVcmwrJy8nK3RoaXMuX3R5cGUrdGhpcy5fbG9jYXRpb25zVXJsKycvJyt0aGlzLl93Zm9cblx0XHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsKVxuXHRcdFx0dmFyIGpzb24gPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cdFx0XHRsZXQgcHJvZHVjdHM7XG5cdFx0XHR0aGlzLl9wcm9kdWN0TGlzdGluZyA9IGpzb247XG5cblx0XHRcdGlmICh0aGlzLl9pZHggIT09IGZhbHNlKSB7ICBwcm9kdWN0cyA9IGF3YWl0IHRoaXMuYnlJbmRleCgpIH1cblx0XHRcdGVsc2UgeyBwcm9kdWN0cyA9IGF3YWl0IHRoaXMuYnlTdWJzZXQoKSB9XG5cdFx0XHRpZiAoY2FsbGJhY2spIHsgY2FsbGJhY2socHJvZHVjdHMsLi4uYXJncyk7IH1cblx0XHRcdGVsc2UgeyByZXR1cm4gcHJvZHVjdHM7IH1cblx0XHR9XG5cdFx0ZWxzZSB7IHJldHVybiBmYWxzZTsgfVxuXHR9XG59XG4qLyIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdGlmKF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0pIHtcblx0XHRyZXR1cm4gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiLy8gbW9kdWxlIGV4cG9ydHMgbXVzdCBiZSByZXR1cm5lZCBmcm9tIHJ1bnRpbWUgc28gZW50cnkgaW5saW5pbmcgaXMgZGlzYWJsZWRcbi8vIHN0YXJ0dXBcbi8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xucmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oNDIzKTtcbiIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IChleHBvcnRzLCBkZWZpbml0aW9uKSA9PiB7XG5cdGZvcih2YXIga2V5IGluIGRlZmluaXRpb24pIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBkZWZpbml0aW9uW2tleV0gfSk7XG5cdFx0fVxuXHR9XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IChvYmosIHByb3ApID0+IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApIiwiLy8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5yID0gKGV4cG9ydHMpID0+IHtcblx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG5cdH1cblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbn07Il0sInNvdXJjZVJvb3QiOiIifQ==