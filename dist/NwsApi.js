window.NwsApi=(()=>{"use strict";var t={423:(t,e,r)=>{r.r(e),r.d(e,{Alert:()=>i,Forecast:()=>a,Product:()=>l});class s{constructor(){}async retryFetch(t,e,r,s){try{let r=await fetch(t,e);if(r.ok)return r;throw new Error("Request to "+t+" failed: "+r.statusText)}catch(i){if(1===s)throw i;return await this.sleep(r),await this.retryFetch(t,e,r,s-1)}}async retryFetchAllJson(t,e,r,s){return await Promise.all(t.map((async t=>(await this.retryFetch(t,e,r,s)).json())))}async sleep(t){return new Promise((e=>setTimeout(e,t)))}buildGetUrl(t,e){let r=t+"?";for(let[t,s]of Object.entries(e))if(null!==s){let e=t,i="";i=Array.isArray(s)?s.join(","):s.toString(),r+="&"+e+"="+i}return r=encodeURI(r),r}}class i extends s{constructor(t,e){super(),this._queryUrl="https://api.weather.gov/alerts",this._requestRetryLimit=4,this._requestRetryTimeout=4e3,this._filters={active:null,start:null,end:null,status:null,message_type:null,event:null,code:null,region_type:null,point:null,region:null,area:null,zone:null,urgency:null,certainty:null,severity:null,limit:null,cursor:null,product:null,siteid:null,zone:null,county:null,latlon:null,newprop:null},this.returnObj={updated:null,features:null},this._filters=Object.assign(this._filters,t)}async getAll(t,...e){let r=this.buildGetUrl(this._queryUrl,this._filters);try{const t=await this.retryFetch(r,null,this._requestRetryTimeout,this._requestRetryLimit);let e=await t.json();this.returnObj.updated=new Date(e.updated),this.returnObj.features=e.features}catch{console.error("NWS API Unavailable or Bad Request: "+r),this.returnObj=!1}if(!t)return this.returnObj;t(this.returnObj,...e)}}class a{constructor(t,e){this._baseUrl="https://api.weather.gov/",this._pointsUrl="points/",this._gridpointsUrl="gridpoints/",this._fcstHourlyUrl="forecast/hourly",this._fcstSummaryUrl="forecast",this._lat=t,this._lon=e,this._metaData=null,this._rawForecast=null,this._summaryForecast=null,this._hourlyForecast=null}async getRawForecast(t,...e){if(this._rawForecast||await this.queryAPIRawForecast(),!t)return this._rawForecast;t(json,...e)}async getHourlyForecast(t,...e){if(this._hourlyForecast||await this.queryAPIHourlyForecast(),!t)return this._hourlyForecast;t(json,...e)}async getSummaryForecast(t,...e){if(this._summaryForecast||await this.queryAPISummaryForecast(),!t)return this._summaryForecast;t(json,...e)}async getMetaData(){return this._metaData||await this.queryAPIPointMetaData(),this._metaData}get gridX(){return this._metaData.properties.gridX}get gridY(){return this._metaData.properties.gridY}get cwa(){return this._metaData.properties.cwa}async queryAPIPointMetaData(){var t=this,e=this._baseUrl+this._pointsUrl+this._lat+","+this._lon;await $.ajax({url:e,dataType:"json",method:"GET",success:function(e){t._metaData=e}})}async queryAPIRawForecast(t,...e){this._metaData||await this.queryAPIPointMetaData();var r=this._baseUrl+this._gridpointsUrl+this.cwa+"/"+this.gridX+","+this.gridY;const s=await fetch(r),i=await s.json();this._rawForecast=i}async queryAPIHourlyForecast(t,...e){this._metaData||await this.queryAPIPointMetaData();var r=this._baseUrl+this._gridpointsUrl+this.cwa+"/"+this.gridX+","+this.gridY+"/"+this._fcstHourlyUrl;const s=await fetch(r),i=await s.json();this._hourlyForecast=i}async queryAPISummaryForecast(t,...e){this._metaData||await this.queryAPIPointMetaData();var r=this._baseUrl+this._gridpointsUrl+this.cwa+"/"+this.gridX+","+this.gridY+"/"+this._fcstSummaryUrl;const s=await fetch(r),i=await s.json();this._summaryForecast=i}async getForecasts(t,e,...r){let s={};if(t.includes("raw")&&(s.raw=await this.getRawForecast()),t.includes("hourly")&&(s.hourly=await this.getHourlyForecast()),t.includes("summary")&&(s.summary=await this.getSummaryForecast()),!e)return s;e(s,...r)}async getRawWeatherDataBetweenPeriods(t,e,r){this._rawForecast||await this.getRawForecast();let s=this._rawForecast.properties[t].values,i=[],a=[],l=!1;return"quantitativePrecipitation"==t&&(l="split"),s.forEach((t=>{i=i.concat(this.hourlyForecastFromRaw(t,l))})),a=i.filter((t=>{if(t.startDate>=e&&t.endDate<=r)return!0})),a}}class l extends s{constructor(t,e){super(),this._queryUrl="https://api.weather.gov/products",this._requestRetryLimit=4,this._requestRetryTimeout=1e3,this._getMostRecentLimit=50,this._getAllLimit=250,this._filters={location:null,start:null,end:null,office:null,wmoid:null,type:null,limit:null},this._productListing=!1,this.returnObj={updated:null,features:null},this._filters=Object.assign(this._filters,t)}async getFullProductListing(){let t=this.buildGetUrl(this._queryUrl,this._filters);try{const e=await this.retryFetch(t,null,this._requestRetryTimeout,this._requestRetryLimit);let r=await e.json();return this._productListing=r["@graph"],this._productListing}catch{throw new Error("NWS API Unavailable or Bad Request: "+t)}}async getMostRecent(t=1,e,...r){t>this._mostRecentLimit&&(t=this._mostRecentLimit),this._productListing||await this.getFullProductListing();let s=this._productListing.slice(0,t),i=await this.getProductsFulltext(s);if(!e)return i;e(i,...r)}async getAll(t,...e){let r=[];r=this._productListing?this._productListing:await this.getFullProductListing(),r.length>this._getAllLimit&&(r=r.slice(0,this._getAllLimit));let s=await this.getMultipleProductsFulltext(r);if(!t)return s;t(s,...e)}async getProductsFulltext(t){let e=[];if(0!==t.length){let r=t.map((t=>t["@id"]));e=await this.retryFetchAllJson(r,null,this._requestRetryTimeout,this._requestRetryLimit)}return console.log(e),e}}}},e={};function r(s){if(e[s])return e[s].exports;var i=e[s]={exports:{}};return t[s](i,i.exports,r),i.exports}return r.d=(t,e)=>{for(var s in e)r.o(e,s)&&!r.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r(423)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9Od3NBcGkvLi9zcmMvanMvQmFzZS5qcyIsIndlYnBhY2s6Ly9Od3NBcGkvLi9zcmMvanMvQWxlcnQuanMiLCJ3ZWJwYWNrOi8vTndzQXBpLy4vc3JjL2pzL0ZvcmVjYXN0LmpzIiwid2VicGFjazovL053c0FwaS8uL3NyYy9qcy9Qcm9kdWN0LmpzIiwid2VicGFjazovL053c0FwaS93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9Od3NBcGkvd2VicGFjay9zdGFydHVwIiwid2VicGFjazovL053c0FwaS93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vTndzQXBpL3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vTndzQXBpL3dlYnBhY2svcnVudGltZS9tYWtlIG5hbWVzcGFjZSBvYmplY3QiXSwibmFtZXMiOlsiQmFzZSIsInVybCIsIm9wdGlvbnMiLCJ3YWl0IiwibnVtVHJpZXMiLCJyZXNwb25zZSIsImZldGNoIiwib2siLCJFcnJvciIsInN0YXR1c1RleHQiLCJlcnIiLCJ0aGlzIiwic2xlZXAiLCJyZXRyeUZldGNoIiwidXJscyIsIlByb21pc2UiLCJhbGwiLCJtYXAiLCJhc3luYyIsImpzb24iLCJtcyIsInJlc29sdmUiLCJzZXRUaW1lb3V0IiwiYmFzZVVybCIsInBhcmFtZXRlcnMiLCJrIiwidiIsIk9iamVjdCIsImVudHJpZXMiLCJwYXJtIiwidmFsIiwiQXJyYXkiLCJpc0FycmF5Iiwiam9pbiIsInRvU3RyaW5nIiwiZW5jb2RlVVJJIiwiQWxlcnQiLCJmaWx0ZXJzIiwic3VwZXIiLCJfcXVlcnlVcmwiLCJfcmVxdWVzdFJldHJ5TGltaXQiLCJfcmVxdWVzdFJldHJ5VGltZW91dCIsIl9maWx0ZXJzIiwiYWN0aXZlIiwic3RhcnQiLCJlbmQiLCJzdGF0dXMiLCJtZXNzYWdlX3R5cGUiLCJldmVudCIsImNvZGUiLCJyZWdpb25fdHlwZSIsInBvaW50IiwicmVnaW9uIiwiYXJlYSIsInpvbmUiLCJ1cmdlbmN5IiwiY2VydGFpbnR5Iiwic2V2ZXJpdHkiLCJsaW1pdCIsImN1cnNvciIsInByb2R1Y3QiLCJzaXRlaWQiLCJjb3VudHkiLCJsYXRsb24iLCJuZXdwcm9wIiwicmV0dXJuT2JqIiwidXBkYXRlZCIsImZlYXR1cmVzIiwiYXNzaWduIiwiY2FsbGJhY2siLCJhcmdzIiwiYnVpbGRHZXRVcmwiLCJEYXRlIiwiY29uc29sZSIsImVycm9yIiwiRm9yZWNhc3RzIiwibGF0IiwibG9uIiwiX2Jhc2VVcmwiLCJfcG9pbnRzVXJsIiwiX2dyaWRwb2ludHNVcmwiLCJfZmNzdEhvdXJseVVybCIsIl9mY3N0U3VtbWFyeVVybCIsIl9sYXQiLCJfbG9uIiwiX21ldGFEYXRhIiwiX3Jhd0ZvcmVjYXN0IiwiX3N1bW1hcnlGb3JlY2FzdCIsIl9ob3VybHlGb3JlY2FzdCIsInF1ZXJ5QVBJUmF3Rm9yZWNhc3QiLCJxdWVyeUFQSUhvdXJseUZvcmVjYXN0IiwicXVlcnlBUElTdW1tYXJ5Rm9yZWNhc3QiLCJxdWVyeUFQSVBvaW50TWV0YURhdGEiLCJwcm9wZXJ0aWVzIiwiZ3JpZFgiLCJncmlkWSIsImN3YSIsInNlbGYiLCIkIiwiYWpheCIsImRhdGFUeXBlIiwibWV0aG9kIiwic3VjY2VzcyIsImRhdGEiLCJ0eXBlcyIsImZvcmVjYXN0RGF0YSIsImluY2x1ZGVzIiwiZ2V0UmF3Rm9yZWNhc3QiLCJnZXRIb3VybHlGb3JlY2FzdCIsImdldFN1bW1hcnlGb3JlY2FzdCIsImVsZW1lbnQiLCJzdGFydERhdGUiLCJlbmREYXRlIiwicmF3RmNzdERhdGEiLCJ2YWx1ZXMiLCJob3VybHlGY3N0RGF0YSIsInZhbGlkSG91cmx5RmNzdERhdGEiLCJjYWxjTWV0aG9kIiwiZm9yRWFjaCIsInJhd0Zjc3QiLCJjb25jYXQiLCJob3VybHlGb3JlY2FzdEZyb21SYXciLCJmaWx0ZXIiLCJmY3N0IiwiUHJvZHVjdCIsIl9nZXRNb3N0UmVjZW50TGltaXQiLCJfZ2V0QWxsTGltaXQiLCJsb2NhdGlvbiIsIm9mZmljZSIsIndtb2lkIiwidHlwZSIsIl9wcm9kdWN0TGlzdGluZyIsIm51bVByb2R1Y3RzIiwiX21vc3RSZWNlbnRMaW1pdCIsImdldEZ1bGxQcm9kdWN0TGlzdGluZyIsInByb2RMaXN0aW5nU3Vic2V0Iiwic2xpY2UiLCJwcm9kRnVsbFRleHRzIiwiZ2V0UHJvZHVjdHNGdWxsdGV4dCIsImxlbmd0aCIsImdldE11bHRpcGxlUHJvZHVjdHNGdWxsdGV4dCIsInByb2R1Y3RMaXN0aW5nIiwicHJvZHVjdFRleHRzIiwicHJvZCIsInJldHJ5RmV0Y2hBbGxKc29uIiwibG9nIiwiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsIl9fd2VicGFja19tb2R1bGVzX18iLCJkIiwiZGVmaW5pdGlvbiIsImtleSIsIm8iLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJvYmoiLCJwcm9wIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiXSwibWFwcGluZ3MiOiIrR0FDZSxNQUFNQSxFQUNwQixlQUlBLGlCQUFpQkMsRUFBS0MsRUFBU0MsRUFBTUMsR0FDbEMsSUFDRCxJQUFJQyxRQUFpQkMsTUFBTUwsRUFBS0MsR0FDaEMsR0FBS0csRUFBU0UsR0FDSixPQUFPRixFQURHLE1BQU0sSUFBSUcsTUFBTSxjQUFjUCxFQUFJLFlBQWNJLEVBQVNJLFlBRTFFLE1BQU1DLEdBQ1QsR0FBaUIsSUFBYk4sRUFBa0IsTUFBTU0sRUFHM0IsYUFETUMsS0FBS0MsTUFBTVQsU0FDSlEsS0FBS0UsV0FBV1osRUFBS0MsRUFBU0MsRUFBTUMsRUFBVyxJQUsvRCx3QkFBd0JVLEVBQUtaLEVBQVFDLEVBQUtDLEdBQ3pDLGFBQWFXLFFBQVFDLElBQ3BCRixFQUFLRyxLQUFJQyxnQkFDZVAsS0FBS0Us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SCxHQUFRQSxFQUFLLFNBQzVDRCxRQUFxQm5JLEtBQUtxSSxrQkFBa0JsSSxFQUFNLEtBQU1ILEtBQUs4QixxQkFBc0I5QixLQUFLNkIsb0JBR3pGLE9BREFpQyxRQUFRd0UsSUFBSUgsR0FDTEEsTUNuRkxJLEVBQTJCLEdBRy9CLFNBQVNDLEVBQW9CQyxHQUU1QixHQUFHRixFQUF5QkUsR0FDM0IsT0FBT0YsRUFBeUJFLEdBQVVDLFFBRzNDLElBQUlDLEVBQVNKLEVBQXlCRSxHQUFZLENBR2pEQyxRQUFTLElBT1YsT0FIQUUsRUFBb0JILEdBQVVFLEVBQVFBLEVBQU9ELFFBQVNGLEdBRy9DRyxFQUFPRCxRQ2pCZixPQ0ZBRixFQUFvQkssRUFBSSxDQUFDSCxFQUFTSSxLQUNqQyxJQUFJLElBQUlDLEtBQU9ELEVBQ1hOLEVBQW9CUSxFQUFFRixFQUFZQyxLQUFTUCxFQUFvQlEsRUFBRU4sRUFBU0ssSUFDNUUvSCxPQUFPaUksZUFBZVAsRUFBU0ssRUFBSyxDQUFFRyxZQUFZLEVBQU1DLElBQUtMLEVBQVdDLE1DSjNFUCxFQUFvQlEsRUFBSSxDQUFDSSxFQUFLQyxJQUFTckksT0FBT3NJLFVBQVVDLGVBQWVDLEtBQUtKLEVBQUtDLEdDQ2pGYixFQUFvQmlCLEVBQUtmLElBQ0gsb0JBQVhnQixRQUEwQkEsT0FBT0MsYUFDMUMzSSxPQUFPaUksZUFBZVAsRUFBU2dCLE9BQU9DLFlBQWEsQ0FBRUMsTUFBTyxXQUU3RDVJLE9BQU9pSSxlQUFlUCxFQUFTLGFBQWMsQ0FBRWtCLE9BQU8sS0hGaERwQixFQUFvQixNIiwiZmlsZSI6Ik53c0FwaS5qcyIsInNvdXJjZXNDb250ZW50IjpbIlxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQmFzZSB7IFxuXHRjb25zdHJ1Y3Rvcigpe1xuXHR9XG5cbiAgLy9yZXRyeXMgYSBwcm9taXNlIG11bHRpcGxlIHRpbWVzIHdpdGggYSB0aW1lb3V0IGluIG9yZGVyIHRvIGRlYWwgd2l0aCBmYWlsZWQgcmVxdWVzdHMuXG5cdGFzeW5jIHJldHJ5RmV0Y2godXJsLCBvcHRpb25zLCB3YWl0LCBudW1Ucmllcykge1xuICAgIHRyeSB7XG5cdFx0XHRsZXQgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwsIG9wdGlvbnMpO1xuXHRcdFx0aWYgKCFyZXNwb25zZS5vaykgeyB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVlc3QgdG8gJyt1cmwrJyBmYWlsZWQ6ICcgKyByZXNwb25zZS5zdGF0dXNUZXh0KTsgfVxuICAgICAgZWxzZSB7IHJldHVybiByZXNwb25zZTsgfVxuICAgIH0gY2F0Y2goZXJyKSB7XG5cdFx0XHRpZiAobnVtVHJpZXMgPT09IDEpIHsgdGhyb3cgZXJyOyB9XG5cdFx0XHRlbHNlIHsgXG5cdFx0XHRcdGF3YWl0IHRoaXMuc2xlZXAod2FpdCk7XG5cdFx0XHRcdHJldHVybiBhd2FpdCB0aGlzLnJldHJ5RmV0Y2godXJsLCBvcHRpb25zLCB3YWl0LCBudW1UcmllcyAtIDEpO1x0XG5cdFx0XHR9XG4gICAgfVxuXHR9O1xuXG5cdGFzeW5jIHJldHJ5RmV0Y2hBbGxKc29uKHVybHMsb3B0aW9ucyx3YWl0LG51bVRyaWVzKSB7IFxuXHRcdHJldHVybiBhd2FpdCBQcm9taXNlLmFsbChcblx0XHRcdHVybHMubWFwKGFzeW5jIHVybCA9PiB7XG5cdFx0XHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5yZXRyeUZldGNoKHVybCxvcHRpb25zLHdhaXQsbnVtVHJpZXMpO1xuXHRcdFx0XHRyZXR1cm4gcmVzcG9uc2UuanNvbigpO1xuXHRcdFx0fSlcblx0XHQpXG5cdH1cblxuXG5cdGFzeW5jIHNsZWVwKG1zKSB7XG4gIFx0cmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCBtcykpO1xuXHR9O1xuXG5cbiAgLy9CdWlsZCBVUkwgZnJvbSBhbGwgcGFyYW1ldGVyc1xuICBidWlsZEdldFVybChiYXNlVXJsLCBwYXJhbWV0ZXJzKSB7XG5cdFx0Ly9PYmplY3QuZW50cmllcyhvYmopLnNvcnQoKGEsIGIpID0+IGJbMF0ubG9jYWxlQ29tcGFyZShhWzBdKSk7XG5cdFx0bGV0IHVybCA9IGJhc2VVcmwrJz8nO1xuICBcdGZvciAobGV0IFtrLCB2XSBvZiBPYmplY3QuZW50cmllcyhwYXJhbWV0ZXJzKSkge1xuXHQgICAgaWYgKHYgIT09IG51bGwpIHtcbiAgICAgIFx0bGV0IHBhcm0gPSBrO1xuICAgICAgXHRsZXQgdmFsID0gJyc7XG4gICAgICBcdGlmIChBcnJheS5pc0FycmF5KHYpKSB7IHZhbCA9IHYuam9pbignLCcpOyB9XG4gICAgICBcdGVsc2UgeyB2YWwgPSB2LnRvU3RyaW5nKCk7IH1cbiAgICAgIFx0dXJsICs9ICcmJyArIHBhcm0gKyAnPScgKyB2YWw7XG4gICAgXHR9XG5cdFx0fVxuXHRcdHVybCA9IGVuY29kZVVSSSh1cmwpO1xuXHRcdHJldHVybiB1cmw7XG5cdH1cdFxuXG5cblxufSIsImltcG9ydCBCYXNlIGZyb20gJy4vQmFzZS5qcyc7XG5cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQWxlcnQgZXh0ZW5kcyBCYXNlICB7XG5cdFxuXHRjb25zdHJ1Y3RvcihmaWx0ZXJzLG9wdGlvbnMpIHtcblx0XHRzdXBlcigpO1xuXHRcdHRoaXMuX3F1ZXJ5VXJsID0gJ2h0dHBzOi8vYXBpLndlYXRoZXIuZ292L2FsZXJ0cyc7XG5cdFx0Ly90aGlzLl9hY3RpdmVVcmwgPSAnL2FjdGl2ZSdcblx0XHQvL3RoaXMuX3pvbmVVcmwgPSAnL3pvbmUnO1xuXHRcdHRoaXMuX3JlcXVlc3RSZXRyeUxpbWl0ID0gNDtcblx0XHR0aGlzLl9yZXF1ZXN0UmV0cnlUaW1lb3V0ID0gNDAwMDsgLy80MDAwO1xuXHRcdHRoaXMuX2ZpbHRlcnMgPSB7XG5cdFx0XHRhY3RpdmUgOiBudWxsLFxuXHRcdFx0c3RhcnQgOiBudWxsLFxuXHRcdFx0ZW5kIDogbnVsbCxcblx0XHRcdHN0YXR1cyA6IG51bGwsXG5cdFx0XHRtZXNzYWdlX3R5cGUgOiBudWxsLFxuXHRcdFx0ZXZlbnQgOiBudWxsLFxuXHRcdFx0Y29kZSA6IG51bGwsXG5cdFx0XHRyZWdpb25fdHlwZSA6IG51bGwsXG5cdFx0XHRwb2ludCA6IG51bGwsXG5cdFx0XHRyZWdpb24gOiBudWxsLFxuXHRcdFx0YXJlYSA6IG51bGwsXG5cdFx0XHR6b25lIDogbnVsbCxcblx0XHRcdHVyZ2VuY3kgOiBudWxsLFxuXHRcdFx0Y2VydGFpbnR5IDogbnVsbCxcblx0XHRcdHNldmVyaXR5IDogbnVsbCxcblx0XHRcdGxpbWl0IDogbnVsbCxcblx0XHRcdGN1cnNvciA6IG51bGwsXG5cdFx0XHRwcm9kdWN0IDogbnVsbCxcblx0XHRcdHNpdGVpZCA6IG51bGwsXG5cdFx0XHR6b25lIDogbnVsbCxcblx0XHRcdGNvdW50eSA6IG51bGwsICBcblx0XHRcdGxhdGxvbiA6IG51bGwsXG5cdFx0XHRuZXdwcm9wIDogbnVsbCxcblx0XHR9XG5cdFx0dGhpcy5yZXR1cm5PYmogPSB7XG5cdFx0XHR1cGRhdGVkIDogbnVsbCxcblx0XHRcdGZlYXR1cmVzIDogbnVsbFxuXHRcdH1cblx0XHR0aGlzLl9maWx0ZXJzID0gT2JqZWN0LmFzc2lnbih0aGlzLl9maWx0ZXJzLCBmaWx0ZXJzKTsgICAvLyBDb3VsZCBhbHNvIGp1c3QgZG8gXCJhZGRlZEJhY2suY29tbWVudHMgPSBDb21tZW50cy5jb21tZW50cztcIiBpZiB5b3Ugb25seSBjYXJlIGFib3V0IHRoaXMgb25lIHByb3BlcnR5XG5cdH07XG5cblx0YXN5bmMgZ2V0QWxsKGNhbGxiYWNrLC4uLmFyZ3Mpe1xuXHRcdGxldCB1cmwgPSB0aGlzLmJ1aWxkR2V0VXJsKHRoaXMuX3F1ZXJ5VXJsLHRoaXMuX2ZpbHRlcnMpO1xuXG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5yZXRyeUZldGNoKHVybCwgbnVsbCwgdGhpcy5fcmVxdWVzdFJldHJ5VGltZW91dCwgdGhpcy5fcmVxdWVzdFJldHJ5TGltaXQpO1xuXHRcdFx0bGV0IGpzb24gPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cdFx0XHR0aGlzLnJldHVybk9iai51cGRhdGVkID0gbmV3IERhdGUoanNvbi51cGRhdGVkKTtcblx0XHRcdHRoaXMucmV0dXJuT2JqLmZlYXR1cmVzID0ganNvbi5mZWF0dXJlcztcblxuXHRcdFx0Ly9pZiAodGhpcy5fcGlsICE9PSBudWxsKSB7IGpzb24gPSBhd2FpdCB0aGlzLmJ5UGlsKCkgfVx0XHRcblx0XHR9IFxuXHRcdGNhdGNoIHtcblx0XHRcdGNvbnNvbGUuZXJyb3IoJ05XUyBBUEkgVW5hdmFpbGFibGUgb3IgQmFkIFJlcXVlc3Q6ICcgKyB1cmwpOyBcblx0XHRcdHRoaXMucmV0dXJuT2JqID0gZmFsc2U7XG5cdFx0fVxuXG5cdFx0aWYgKGNhbGxiYWNrKSB7IGNhbGxiYWNrKHRoaXMucmV0dXJuT2JqLC4uLmFyZ3MpOyB9XG5cdFx0ZWxzZSB7IHJldHVybiB0aGlzLnJldHVybk9iajsgfVx0XHRcdFxuXHR9O1xuXG59XG4iLCJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcmVjYXN0cyB7XG5cblx0Y29uc3RydWN0b3IobGF0LGxvbikge1xuXHRcdHRoaXMuX2Jhc2VVcmwgPSAnaHR0cHM6Ly9hcGkud2VhdGhlci5nb3YvJztcblx0XHR0aGlzLl9wb2ludHNVcmwgPSAncG9pbnRzLyc7XG5cdFx0dGhpcy5fZ3JpZHBvaW50c1VybCA9ICdncmlkcG9pbnRzLyc7XG5cdFx0dGhpcy5fZmNzdEhvdXJseVVybCA9ICdmb3JlY2FzdC9ob3VybHknO1xuXHRcdHRoaXMuX2Zjc3RTdW1tYXJ5VXJsID0gJ2ZvcmVjYXN0Jztcblx0XG5cdFx0dGhpcy5fbGF0ID0gbGF0O1xuXHRcdHRoaXMuX2xvbiA9IGxvbjtcblx0XHR0aGlzLl9tZXRhRGF0YSA9IG51bGw7XG5cdFx0dGhpcy5fcmF3Rm9yZWNhc3QgPSBudWxsO1xuXHRcdHRoaXMuX3N1bW1hcnlGb3JlY2FzdCA9IG51bGw7XG5cdFx0dGhpcy5faG91cmx5Rm9yZWNhc3QgPSBudWxsO1xuXHR9XG5cblx0YXN5bmMgZ2V0UmF3Rm9yZWNhc3QoY2FsbGJhY2ssLi4uYXJncyl7XG5cdFx0aWYgKCF0aGlzLl9yYXdGb3JlY2FzdCl7IGF3YWl0IHRoaXMucXVlcnlBUElSYXdGb3JlY2FzdCgpOyB9XG5cdFx0aWYgKGNhbGxiYWNrKSAgeyBjYWxsYmFjayhqc29uLC4uLmFyZ3MpOyB9XG5cdFx0ZWxzZSB7IHJldHVybiB0aGlzLl9yYXdGb3JlY2FzdDsgfVxuXHR9XG5cdGFzeW5jIGdldEhvdXJseUZvcmVjYXN0KGNhbGxiYWNrLC4uLmFyZ3Mpe1xuXHRcdGlmICghdGhpcy5faG91cmx5Rm9yZWNhc3QpeyBhd2FpdCB0aGlzLnF1ZXJ5QVBJSG91cmx5Rm9yZWNhc3QoKTsgfVxuXHRcdGlmIChjYWxsYmFjaykgIHsgY2FsbGJhY2soanNvbiwuLi5hcmdzKTsgfVxuXHRcdGVsc2UgeyByZXR1cm4gdGhpcy5faG91cmx5Rm9yZWNhc3Q7IH1cblx0fVxuXHRhc3luYyBnZXRTdW1tYXJ5Rm9yZWNhc3QoY2FsbGJhY2ssLi4uYXJncyl7XG5cdFx0aWYgKCF0aGlzLl9zdW1tYXJ5Rm9yZWNhc3QpeyBhd2FpdCB0aGlzLnF1ZXJ5QVBJU3VtbWFyeUZvcmVjYXN0KCk7IH1cblx0XHRpZiAoY2FsbGJhY2spICB7IGNhbGxiYWNrKGpzb24sLi4uYXJncyk7IH1cblx0XHRlbHNlIHsgcmV0dXJuIHRoaXMuX3N1bW1hcnlGb3JlY2FzdDsgfVxuXHR9XG5cdGFzeW5jIGdldE1ldGFEYXRhKCl7XG5cdFx0aWYgKCF0aGlzLl9tZXRhRGF0YSl7IGF3YWl0IHRoaXMucXVlcnlBUElQb2ludE1ldGFEYXRhKCk7XHR9XG5cdFx0cmV0dXJuIHRoaXMuX21ldGFEYXRhOyBcblx0fVxuXHRcblx0Z2V0IGdyaWRYKCkgeyByZXR1cm4gdGhpcy5fbWV0YURhdGEucHJvcGVydGllcy5ncmlkWDsgfVxuXHRnZXQgZ3JpZFkoKSB7IHJldHVybiB0aGlzLl9tZXRhRGF0YS5wcm9wZXJ0aWVzLmdyaWRZOyB9XG5cdGdldCBjd2EoKSB7IHJldHVybiB0aGlzLl9tZXRhRGF0YS5wcm9wZXJ0aWVzLmN3YTsgfVxuXG5cdGFzeW5jIHF1ZXJ5QVBJUG9pbnRNZXRhRGF0YSgpIHtcblx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cdFx0dmFyIHVybCA9IHRoaXMuX2Jhc2VVcmwrdGhpcy5fcG9pbnRzVXJsK3RoaXMuX2xhdCsnLCcrdGhpcy5fbG9uO1xuXHRcdGF3YWl0ICQuYWpheCh7XG5cdFx0XHR1cmw6IHVybCxcblx0XHRcdGRhdGFUeXBlOiAnanNvbicsXG5cdFx0XHRtZXRob2Q6J0dFVCcsXG5cdFx0XHRzdWNjZXNzOiBmdW5jdGlvbihkYXRhKXsgXG5cdFx0XHRcdHNlbGYuX21ldGFEYXRhID0gZGF0YTsgXG5cdFx0XHR9XG5cdFx0fSk7XG5cdH07XG5cdGFzeW5jIHF1ZXJ5QVBJUmF3Rm9yZWNhc3QoY2FsbGJhY2ssLi4uYXJncykge1xuXHRcdGlmICghdGhpcy5fbWV0YURhdGEpeyBhd2FpdCB0aGlzLnF1ZXJ5QVBJUG9pbnRNZXRhRGF0YSgpO1x0fVxuXHRcdHZhciB1cmwgPSB0aGlzLl9iYXNlVXJsK3RoaXMuX2dyaWRwb2ludHNVcmwrdGhpcy5jd2ErJy8nK3RoaXMuZ3JpZFgrJywnK3RoaXMuZ3JpZFlcblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybClcblx0XHRjb25zdCBqc29uID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXHRcdHRoaXMuX3Jhd0ZvcmVjYXN0ID0ganNvbiBcblx0fVxuXHRhc3luYyBxdWVyeUFQSUhvdXJseUZvcmVjYXN0KGNhbGxiYWNrLC4uLmFyZ3MpIHtcblx0XHRpZiAoIXRoaXMuX21ldGFEYXRhKXsgYXdhaXQgdGhpcy5xdWVyeUFQSVBvaW50TWV0YURhdGEoKTtcdH1cblx0XHR2YXIgdXJsID0gdGhpcy5fYmFzZVVybCt0aGlzLl9ncmlkcG9pbnRzVXJsK3RoaXMuY3dhKycvJyt0aGlzLmdyaWRYKycsJyt0aGlzLmdyaWRZKycvJyt0aGlzLl9mY3N0SG91cmx5VXJsO1xuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsKVxuXHRcdGNvbnN0IGpzb24gPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cdFx0dGhpcy5faG91cmx5Rm9yZWNhc3QgPSBqc29uIFxuXHR9XG5cdGFzeW5jIHF1ZXJ5QVBJU3VtbWFyeUZvcmVjYXN0KGNhbGxiYWNrLC4uLmFyZ3MpIHtcblx0XHRpZiAoIXRoaXMuX21ldGFEYXRhKXsgYXdhaXQgdGhpcy5xdWVyeUFQSVBvaW50TWV0YURhdGEoKTtcdH1cblx0XHR2YXIgdXJsID0gdGhpcy5fYmFzZVVybCt0aGlzLl9ncmlkcG9pbnRzVXJsK3RoaXMuY3dhKycvJyt0aGlzLmdyaWRYKycsJyt0aGlzLmdyaWRZKycvJyt0aGlzLl9mY3N0U3VtbWFyeVVybDtcblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybClcblx0XHRjb25zdCBqc29uID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXHRcdHRoaXMuX3N1bW1hcnlGb3JlY2FzdCA9IGpzb24gXG5cdH1cblx0YXN5bmMgZ2V0Rm9yZWNhc3RzKHR5cGVzLGNhbGxiYWNrLC4uLmFyZ3MpIHtcblx0XHRsZXQgZm9yZWNhc3REYXRhID0ge31cblx0XHRpZiAodHlwZXMuaW5jbHVkZXMoJ3JhdycpKSB7IGZvcmVjYXN0RGF0YVsncmF3J10gPSBhd2FpdCB0aGlzLmdldFJhd0ZvcmVjYXN0KCk7IH1cblx0XHRpZiAodHlwZXMuaW5jbHVkZXMoJ2hvdXJseScpKSB7IGZvcmVjYXN0RGF0YVsnaG91cmx5J10gPSBhd2FpdCB0aGlzLmdldEhvdXJseUZvcmVjYXN0KCk7IH1cblx0XHRpZiAodHlwZXMuaW5jbHVkZXMoJ3N1bW1hcnknKSkgeyBmb3JlY2FzdERhdGFbJ3N1bW1hcnknXSA9IGF3YWl0IHRoaXMuZ2V0U3VtbWFyeUZvcmVjYXN0KCk7IH1cblx0XHRpZiAoY2FsbGJhY2spICB7IGNhbGxiYWNrKGZvcmVjYXN0RGF0YSwuLi5hcmdzKTsgfVxuXHRcdGVsc2UgeyByZXR1cm4gZm9yZWNhc3REYXRhIH1cblx0fVxuXG5cdGFzeW5jIGdldFJhd1dlYXRoZXJEYXRhQmV0d2VlblBlcmlvZHMoZWxlbWVudCxzdGFydERhdGUsZW5kRGF0ZSl7XG5cdFx0aWYgKCF0aGlzLl9yYXdGb3JlY2FzdCl7IGF3YWl0IHRoaXMuZ2V0UmF3Rm9yZWNhc3QoKTtcdH1cblx0XHRsZXQgcmF3RmNzdERhdGEgPSB0aGlzLl9yYXdGb3JlY2FzdC5wcm9wZXJ0aWVzW2VsZW1lbnRdLnZhbHVlcztcblx0XHRsZXQgaG91cmx5RmNzdERhdGEgPSBbXTtcblx0XHRsZXQgdmFsaWRIb3VybHlGY3N0RGF0YSA9IFtdO1xuXHRcdGxldCBjYWxjTWV0aG9kID0gZmFsc2U7XG5cdFx0aWYgKGVsZW1lbnQgPT0gJ3F1YW50aXRhdGl2ZVByZWNpcGl0YXRpb24nKSB7IGNhbGNNZXRob2QgPSAnc3BsaXQnOyB9XG5cdFx0cmF3RmNzdERhdGEuZm9yRWFjaCggcmF3RmNzdCA9PiB7XG5cdFx0XHRcblx0XHRcdGhvdXJseUZjc3REYXRhID0gaG91cmx5RmNzdERhdGEuY29uY2F0KHRoaXMuaG91cmx5Rm9yZWNhc3RGcm9tUmF3KHJhd0Zjc3QsY2FsY01ldGhvZCkpO1xuXHRcdH0pO1xuXHRcdFxuXHRcdHZhbGlkSG91cmx5RmNzdERhdGEgPSBob3VybHlGY3N0RGF0YS5maWx0ZXIoKGZjc3QpID0+IHtcblx0XHRcdGlmICgoZmNzdC5zdGFydERhdGUgPj0gc3RhcnREYXRlKSAmJiAoZmNzdC5lbmREYXRlIDw9IGVuZERhdGUpKSB7IHJldHVybiB0cnVlOyB9XG5cdFx0fSlcblx0XHRyZXR1cm4gdmFsaWRIb3VybHlGY3N0RGF0YTtcblx0fVxuXHRcbi8qXHRob3VybHlUaW1lc0JldHdlZW4oc3RhcnREYXRlLGVuZERhdGUpe1xuXHRcdGxldCBkZXNpcmVkRm9yZWNhc3REYXRlcyA9IFtdO1xuXHRcdGxldCBob3VybHlEYXRlID0gc3RhcnREYXRlOyBcblx0XHR3aGlsZSAoaG91cmx5RGF0ZSA8IGVuZERhdGUpe1xuXHRcdFx0ZGVzaXJlZEZvcmVjYXN0RGF0ZXMucHVzaChuZXcgRGF0ZShob3VybHlEYXRlKSlcblx0XHRcdGhvdXJseURhdGUgPSBuZXcgRGF0ZShob3VybHlEYXRlLnNldEhvdXJzKGhvdXJseURhdGUuZ2V0SG91cnMoKSArIDEpKTtcblx0XHR9XG5cdFx0cmV0dXJuIGRlc2lyZWRGb3JlY2FzdERhdGVzO1xuXHR9Ki9cblxuLypcdGhvdXJseUZvcmVjYXN0RnJvbVJhdyh3eERhdGEsY2FsYyl7XG5cdFx0bGV0IHd4RGF0YVRpbWVQZXJpb2QgPSB0aGlzLmRlY29kZVJhd0ZvcmVjYXN0VGltZVBlcmlvZCh3eERhdGEudmFsaWRUaW1lKVxuXHRcdGxldCBob3VybHlGb3JlY2FzdERhdGEgPSBbXTtcblx0XHRsZXQgaG91cmx5RGF0ZSA9IHd4RGF0YVRpbWVQZXJpb2Quc3RhcnREYXRlO1xuXHRcdGxldCBob3VybHlWYWx1ZTtcblx0XHRpZiAoY2FsYyA9PSAnc3BsaXQnKSB7IGhvdXJseVZhbHVlID0gd3hEYXRhLnZhbHVlIC8gd3hEYXRhVGltZVBlcmlvZC5kdXJhdGlvbjsgfVxuXHRcdGVsc2UgeyBob3VybHlWYWx1ZSA9IHd4RGF0YS52YWx1ZTsgfVxuXHRcdHdoaWxlIChob3VybHlEYXRlIDwgd3hEYXRhVGltZVBlcmlvZC5lbmREYXRlKXtcblx0XHRcdGxldCBob3VybHlTdGFydERhdGUgPSBuZXcgRGF0ZShob3VybHlEYXRlKTtcblx0XHRcdGhvdXJseURhdGUgPSBuZXcgRGF0ZShob3VybHlEYXRlLnNldEhvdXJzKGhvdXJseURhdGUuZ2V0SG91cnMoKSArIDEpKVxuXHRcdFx0bGV0IGhvdXJseUVuZERhdGUgPSBuZXcgRGF0ZShob3VybHlEYXRlKTsgXG5cdFx0XHRob3VybHlGb3JlY2FzdERhdGEucHVzaCh7XG5cdFx0XHRcdHN0YXJ0RGF0ZSA6IGhvdXJseVN0YXJ0RGF0ZSxcblx0XHRcdFx0ZW5kRGF0ZSA6IGhvdXJseUVuZERhdGUsXG5cdFx0XHRcdHZhbHVlIDogaG91cmx5VmFsdWVcblx0XHRcdH0pXG5cdFx0fVxuXHRcdHJldHVybiBob3VybHlGb3JlY2FzdERhdGE7XG5cdH1cblx0XG5cblx0ZGVjb2RlUmF3Rm9yZWNhc3RUaW1lUGVyaW9kKHZhbGlkVGltZSl7XG5cdFx0bGV0IHN0YXJ0ID0gdmFsaWRUaW1lLnNwbGl0KCcvJylbMF07XG5cdFx0bGV0IGR1cmF0aW9uID0gdmFsaWRUaW1lLnNwbGl0KCcvJylbMV07XG5cdFx0ZHVyYXRpb24gPSBwYXJzZUludChkdXJhdGlvbi5zdWJzdHJpbmcoZHVyYXRpb24ubGFzdEluZGV4T2YoXCJUXCIpICsgMSxkdXJhdGlvbi5sYXN0SW5kZXhPZihcIkhcIikpKVxuXHRcdGxldCBzdGFydERhdGUgPSBuZXcgRGF0ZShzdGFydCk7XG5cdFx0bGV0IGVuZERhdGUgPSBuZXcgRGF0ZShzdGFydCk7XG5cdFx0ZW5kRGF0ZS5zZXRIb3VycyhlbmREYXRlLmdldEhvdXJzKCkrZHVyYXRpb24pO1xuXHRcdHJldHVybiB7XCJzdGFydERhdGVcIjogc3RhcnREYXRlLCBcImVuZERhdGVcIjogZW5kRGF0ZSwgXCJkdXJhdGlvblwiOiBkdXJhdGlvbiB9O1xuXHR9Ki9cblxuXG5cblx0XG4vL1x0XHRjb25zdCBzdW1tYXJ5RmNzdCA9IGF3YWl0IHRoaXMuc3VtbWFyaHlGb3JlY2FzdCgpO1xuLy9cdFx0aWYgKCF0aGlzLl9tZXRhRGF0YSl7IGF3YWl0IHRoaXMuYXBpUG9pbnRNZXRhRGF0YSgpO1x0fVxuLy9cdFx0dmFyIHVybCA9IHRoaXMuX2Jhc2VVcmwrdGhpcy5fZ3JpZHBvaW50c1VybCt0aGlzLl9jd2ErJy8nK3RoaXMuX2dyaWRYKycsJyt0aGlzLl9ncmlkWSsnLycrdGhpcy5fZmNzdFN1bW1hcnlVcmw7XG4vL1x0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybClcbi8vXHRcdGNvbnN0IGpzb24gPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4vL1x0XHRjYWxsYmFjayhqc29uLC4uLmFyZ3MpXG4vL1x0fVxuXG59IiwiaW1wb3J0IEJhc2UgZnJvbSAnLi9CYXNlLmpzJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUHJvZHVjdCBleHRlbmRzIEJhc2UgIHtcblx0XG5cdGNvbnN0cnVjdG9yKGZpbHRlcnMsb3B0aW9ucykge1xuXHRcdHN1cGVyKCk7XG5cdFx0dGhpcy5fcXVlcnlVcmwgPSAnaHR0cHM6Ly9hcGkud2VhdGhlci5nb3YvcHJvZHVjdHMnO1xuXHRcdC8vdGhpcy5fYWN0aXZlVXJsID0gJy9hY3RpdmUnXG5cdFx0Ly90aGlzLl96b25lVXJsID0gJy96b25lJztcblx0XHR0aGlzLl9yZXF1ZXN0UmV0cnlMaW1pdCA9IDQ7XG5cdFx0dGhpcy5fcmVxdWVzdFJldHJ5VGltZW91dCA9IDEwMDA7IC8vNDAwMDtcblx0XHR0aGlzLl9nZXRNb3N0UmVjZW50TGltaXQgPSA1MDtcblx0XHR0aGlzLl9nZXRBbGxMaW1pdCA9IDI1MDtcblx0XHR0aGlzLl9maWx0ZXJzID0ge1xuXHRcdFx0bG9jYXRpb24gOiBudWxsLFxuXHRcdFx0c3RhcnQgOiBudWxsLFxuXHRcdFx0ZW5kIDogbnVsbCxcblx0XHRcdG9mZmljZSA6IG51bGwsXG5cdFx0XHR3bW9pZCA6IG51bGwsXG5cdFx0XHR0eXBlIDogbnVsbCxcblx0XHRcdGxpbWl0IDogbnVsbCxcblx0XHR9XG5cblx0XHR0aGlzLl9wcm9kdWN0TGlzdGluZyA9IGZhbHNlO1xuXG5cdFx0dGhpcy5yZXR1cm5PYmogPSB7XG5cdFx0XHR1cGRhdGVkIDogbnVsbCxcblx0XHRcdGZlYXR1cmVzIDogbnVsbFxuXHRcdH1cblx0XHR0aGlzLl9maWx0ZXJzID0gT2JqZWN0LmFzc2lnbih0aGlzLl9maWx0ZXJzLCBmaWx0ZXJzKTsgICAvLyBDb3VsZCBhbHNvIGp1c3QgZG8gXCJhZGRlZEJhY2suY29tbWVudHMgPSBDb21tZW50cy5jb21tZW50cztcIiBpZiB5b3Ugb25seSBjYXJlIGFib3V0IHRoaXMgb25lIHByb3BlcnR5XG5cdH07XG5cblxuXHRhc3luYyBnZXRGdWxsUHJvZHVjdExpc3RpbmcoKXtcblx0XHRsZXQgdXJsID0gdGhpcy5idWlsZEdldFVybCh0aGlzLl9xdWVyeVVybCx0aGlzLl9maWx0ZXJzKTtcblx0XHR0cnkge1xuXHRcdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLnJldHJ5RmV0Y2godXJsLCBudWxsLCB0aGlzLl9yZXF1ZXN0UmV0cnlUaW1lb3V0LCB0aGlzLl9yZXF1ZXN0UmV0cnlMaW1pdCk7XG5cdFx0XHRsZXQganNvbiA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblx0XHRcdHRoaXMuX3Byb2R1Y3RMaXN0aW5nID0ganNvblsnQGdyYXBoJ107XHRcblx0XHRcdHJldHVybiB0aGlzLl9wcm9kdWN0TGlzdGluZztcblx0XHR9IFxuXHRcdGNhdGNoIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignTldTIEFQSSBVbmF2YWlsYWJsZSBvciBCYWQgUmVxdWVzdDogJyArIHVybCk7IFxuXHRcdFx0Ly90aGlzLl9wcm9kdWN0TGlzdGluZyA9IGZhbHNlO1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblx0XHQvL2lmIChjYWxsYmFjaykgeyBjYWxsYmFjayh0aGlzLnJldHVybk9iaiwuLi5hcmdzKTsgfVxuXHRcdC8vZWxzZSB7IHJldHVybiB0aGlzLnJldHVybk9iajsgfVx0XHRcdFxuXHR9O1xuXG5cdC8vUmV0dXJucyB0aGUgbW9zdCByZWNlbnQgcHJvZHVjdHMgZ2l2ZW4gYSB0b3RhbCBudW1iZXIgdG8gZ28gYmFjay5cblx0YXN5bmMgZ2V0TW9zdFJlY2VudChudW1Qcm9kdWN0cyA9IDEsY2FsbGJhY2ssLi4uYXJncyl7XG5cdFx0Ly9NYWtlIHN1cmUgd2UncmUgbm90IHJlcXVlc3RpbmcgbW9yZSB0aGVuIG91ciBtYXggbnVtYmVyIG9mIHByb2R1Y3RzLlxuXHRcdGlmIChudW1Qcm9kdWN0cyA+IHRoaXMuX21vc3RSZWNlbnRMaW1pdCkgeyBudW1Qcm9kdWN0cyA9IHRoaXMuX21vc3RSZWNlbnRMaW1pdDsgfVxuXHRcdGlmICghdGhpcy5fcHJvZHVjdExpc3RpbmcpIHsgYXdhaXQgdGhpcy5nZXRGdWxsUHJvZHVjdExpc3RpbmcoKTsgfVxuXHRcdGxldCBwcm9kTGlzdGluZ1N1YnNldCA9IHRoaXMuX3Byb2R1Y3RMaXN0aW5nLnNsaWNlKDAsbnVtUHJvZHVjdHMpO1xuXHRcdGxldCBwcm9kRnVsbFRleHRzID0gYXdhaXQgdGhpcy5nZXRQcm9kdWN0c0Z1bGx0ZXh0KHByb2RMaXN0aW5nU3Vic2V0KTtcblxuXHRcdFxuXHRcdGlmIChjYWxsYmFjaykgIHsgY2FsbGJhY2socHJvZEZ1bGxUZXh0cywuLi5hcmdzKTsgfVxuXHRcdGVsc2UgeyByZXR1cm4gcHJvZEZ1bGxUZXh0czsgfVxuXHR9XG5cblx0Ly9HZXQgYWxsIHByb2R1Y3RzIGZyb20gdGhlIGN1cnJlbnQgcHJvZHVjdCBsaXN0aW5nLiAgTm90ZSBjYXV0aW9uIGhhcyB0byBiZSB1c2VkIHdpdGggdGhpcy5cblx0Ly9QZXJoYXBzIEkgbmVlZCBhbm90aGVyIG1heGltdW0gb3IgcmF0ZSBsaW1pdGVyIHRvIG5vdCBhbGxvdyBmb2xrcyB0byBhY2NpZGV0bmFsbHkgcXVlcnkgNTAwMCBwcm9kdWN0cz9cblx0YXN5bmMgZ2V0QWxsKGNhbGxiYWNrLC4uLmFyZ3Mpe1xuXHRcdGxldCBwcm9kTGlzdGluZ1N1YnNldCA9IFtdO1xuXHRcdGlmICghdGhpcy5fcHJvZHVjdExpc3RpbmcpIHsgcHJvZExpc3RpbmdTdWJzZXQgPSBhd2FpdCB0aGlzLmdldEZ1bGxQcm9kdWN0TGlzdGluZygpOyB9XG5cdFx0ZWxzZSB7IHByb2RMaXN0aW5nU3Vic2V0ID0gdGhpcy5fcHJvZHVjdExpc3Rpbmc7IH1cblx0XHRpZiAocHJvZExpc3RpbmdTdWJzZXQubGVuZ3RoID4gdGhpcy5fZ2V0QWxsTGltaXQpIHsgcHJvZExpc3RpbmdTdWJzZXQgPSBwcm9kTGlzdGluZ1N1YnNldC5zbGljZSgwLHRoaXMuX2dldEFsbExpbWl0KTsgfVxuXHRcdFxuXHRcdGxldCBwcm9kRnVsbFRleHRzID0gYXdhaXQgdGhpcy5nZXRNdWx0aXBsZVByb2R1Y3RzRnVsbHRleHQocHJvZExpc3RpbmdTdWJzZXQpO1xuXHRcdGlmIChjYWxsYmFjaykgIHsgY2FsbGJhY2socHJvZEZ1bGxUZXh0cywuLi5hcmdzKTsgfVxuXHRcdGVsc2UgeyByZXR1cm4gcHJvZEZ1bGxUZXh0czsgfVxuXHR9XG5cdFxuXHQvL0dldCBhbiBhcnJheSBvZiBhbGwgcHJvZHVjdHMgbGlzdGVkIGluIHRoZSBsaXN0aW5nLlxuXHRhc3luYyBnZXRQcm9kdWN0c0Z1bGx0ZXh0KHByb2R1Y3RMaXN0aW5nKXtcblx0XHRsZXQgcHJvZHVjdFRleHRzID0gW107XG5cdFx0aWYgKHByb2R1Y3RMaXN0aW5nLmxlbmd0aCAhPT0gMCkge1xuXHRcdFx0bGV0IHVybHMgPSBwcm9kdWN0TGlzdGluZy5tYXAoIHByb2QgPT4gcHJvZFsnQGlkJ10pO1x0XHRcdFxuXHRcdFx0cHJvZHVjdFRleHRzID0gYXdhaXQgdGhpcy5yZXRyeUZldGNoQWxsSnNvbih1cmxzLCBudWxsLCB0aGlzLl9yZXF1ZXN0UmV0cnlUaW1lb3V0LCB0aGlzLl9yZXF1ZXN0UmV0cnlMaW1pdCk7XG5cdFx0fSBcblx0XHRjb25zb2xlLmxvZyhwcm9kdWN0VGV4dHMpO1xuXHRcdHJldHVybiBwcm9kdWN0VGV4dHM7XG5cdH1cblxuXHQvL1JldHVybnMgdGhlIGxhdGVzdCBwcm9kdWN0XG4vKlx0YXN5bmMgZ2V0TGF0ZXN0KGNhbGxiYWNrLC4uLmFyZ3Mpe1xuXHRcdHRoaXMuZ2V0TW9zdFJlY2VudCgxLGNhbGxiYWNrLC4uLmFyZ3MpXG5cdH0qL1xuXG5cblx0XG4vKlx0Ly9SZXR1cm5zIGFsbCBvciBhIHN1YnNldCBvZiB0aGUgcHJvZHVjdHNcblx0YXN5bmMgYnlTdWJzZXQoaWR4LGNhbGxiYWNrLC4uLmFyZ3Mpe1xuXHRcdGxldCBqc29uID0gW107XG5cdFx0bGV0IHByb2RBcnJheSA9IHRoaXMuX3Byb2R1Y3RMaXN0aW5nWydAZ3JhcGgnXTtcblx0XHRpZiAocHJvZEFycmF5Lmxlbmd0aCAhPT0gMCkge1x0XG5cdFx0XHQvL3NsaWNlIG9mZiBhbnkgZXh0cmEgaWYgYSBsaW1pdCBpcyBzZXQuXG5cdFx0XHRpZiAodGhpcy5fbGltaXQpIHsgcHJvZEFycmF5ID0gcHJvZEFycmF5LnNsaWNlKDAsdGhpcy5fbGltaXQgKX1cblxuXHRcdFx0anNvbiA9IGF3YWl0IFByb21pc2UuYWxsKFxuXHRcdFx0XHRwcm9kQXJyYXkubWFwKGFzeW5jIHByb2QgPT4ge1xuXHRcdFx0XHRcdHZhciB1cmwgPSBwcm9kWydAaWQnXTtcblx0XHRcdFx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybClcblx0XHRcdFx0XHRyZXR1cm4gcmVzcG9uc2UuanNvbigpO1xuXHRcdFx0XHR9KVxuXHRcdFx0KVxuXHRcdH1cblx0XHRpZiAoY2FsbGJhY2spICB7IGNhbGxiYWNrKGpzb24sLi4uYXJncyk7IH1cblx0XHRlbHNlIHsgcmV0dXJuIGpzb247IH1cblx0fVxuKi9cbn1cblxuXG5cbi8qXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQcm9kdWN0cyB7XG5cdFxuXHRjb25zdHJ1Y3Rvcih0eXBlID0gbnVsbCwgd2ZvID0gbnVsbCwgaWR4ID0gZmFsc2UsIGxpbWl0ID0gZmFsc2UsIHN0YXJ0RGF0ZSA9IGZhbHNlLCBlbmREYXRlID0gZmFsc2UpIHtcblx0XHR0aGlzLl9iYXNlVXJsID0gJ2h0dHBzOi8vYXBpLndlYXRoZXIuZ292Lyc7XG5cdFx0dGhpcy5fcHJvZHVjdHNVcmwgPSAncHJvZHVjdHMnXG5cdFx0dGhpcy5fbG9jYXRpb25zVXJsID0gJy9sb2NhdGlvbnMnXG5cdFx0dGhpcy5fdHlwZXNVcmwgPSAnL3R5cGVzJztcblxuXHRcdHRoaXMuX3R5cGUgPSB0eXBlO1xuXHRcdHRoaXMuX3dmbyA9IHdmbztcblx0XHR0aGlzLl9pZHggPSBpZHg7XG5cdFx0dGhpcy5fbGltaXQgPSBsaW1pdDtcblx0XHR0aGlzLl9zdGFydERhdGUgPSBzdGFydERhdGU7XG5cdFx0dGhpcy5fZW5kRGF0ZSA9IGVuZERhdGU7XG5cdFx0dGhpcy5fcHJvZHVjdExpc3RpbmcgPSBudWxsXG5cdH1cblxuXHQvL1JldHVybnMgYSBzaW5nbGUgcHJvZHVjdCBieSBhbiBpbmRleFxuXHRhc3luYyBieUluZGV4KGlkeCxjYWxsYmFjaywuLi5hcmdzKXtcblx0XHRsZXQganNvbiA9IHt9O1xuXHRcdGlmICh0aGlzLl9wcm9kdWN0TGlzdGluZ1snQGdyYXBoJ10ubGVuZ3RoICE9PSAwKSB7XG5cdFx0XHR2YXIgdXJsID0gdGhpcy5fcHJvZHVjdExpc3RpbmdbJ0BncmFwaCddW3RoaXMuX2lkeF1bJ0BpZCddO1xuXHRcdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwpXG5cdFx0XHRqc29uID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXHRcdH1cblx0XHRpZiAoY2FsbGJhY2spICB7IGNhbGxiYWNrKGpzb24sLi4uYXJncyk7IH1cblx0XHRlbHNlIHsgcmV0dXJuIGpzb247IH1cblx0fVxuXG5cdC8vUmV0dXJucyBhbGwgb3IgYSBzdWJzZXQgb2YgdGhlIHByb2R1Y3RzXG5cdGFzeW5jIGJ5U3Vic2V0KGlkeCxjYWxsYmFjaywuLi5hcmdzKXtcblx0XHRsZXQganNvbiA9IFtdO1xuXHRcdGxldCBwcm9kQXJyYXkgPSB0aGlzLl9wcm9kdWN0TGlzdGluZ1snQGdyYXBoJ107XG5cdFx0aWYgKHByb2RBcnJheS5sZW5ndGggIT09IDApIHtcblx0XHRcdFx0Ly9maWx0ZXIgb3V0IGJ5IHN0YXJ0IGRhdGVcblx0XHRcdGlmICh0aGlzLl9zdGFydERhdGUpIHsgXG5cdFx0XHRcdHByb2RBcnJheSA9IHByb2RBcnJheS5maWx0ZXIoIHByb2R1Y3QgPT4ge1xuXHRcdFx0XHRcdHJldHVybiB0aGlzLl9zdGFydERhdGUgPCBuZXcgRGF0ZShwcm9kdWN0Lmlzc3VhbmNlVGltZSk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdFx0aWYgKHRoaXMuX2VuZERhdGUpIHsgXG5cdFx0XHRcdHByb2RBcnJheSA9IHByb2RBcnJheS5maWx0ZXIoIHByb2R1Y3QgPT4ge1xuXHRcdFx0XHRcdHJldHVybiB0aGlzLl9lbmREYXRlID4gbmV3IERhdGUocHJvZHVjdC5pc3N1YW5jZVRpbWUpXG5cdFx0XHRcdH0pXG5cdFx0XHR9XHRcdFx0XG5cdFx0XHQvL3NsaWNlIG9mZiBhbnkgZXh0cmEgaWYgYSBsaW1pdCBpcyBzZXQuXG5cdFx0XHRpZiAodGhpcy5fbGltaXQpIHsgcHJvZEFycmF5ID0gcHJvZEFycmF5LnNsaWNlKDAsdGhpcy5fbGltaXQgKX1cblxuXHRcdFx0anNvbiA9IGF3YWl0IFByb21pc2UuYWxsKFxuXHRcdFx0XHRwcm9kQXJyYXkubWFwKGFzeW5jIHByb2QgPT4ge1xuXHRcdFx0XHRcdHZhciB1cmwgPSBwcm9kWydAaWQnXTtcblx0XHRcdFx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybClcblx0XHRcdFx0XHRyZXR1cm4gcmVzcG9uc2UuanNvbigpO1xuXHRcdFx0XHR9KVxuXHRcdFx0KVxuXHRcdH1cblx0XHRpZiAoY2FsbGJhY2spICB7IGNhbGxiYWNrKGpzb24sLi4uYXJncyk7IH1cblx0XHRlbHNlIHsgcmV0dXJuIGpzb247IH1cblx0fVxuXG5cdGFzeW5jIGdldFByb2R1Y3RzQnlMb2NhdGlvbkFuZFR5cGUoY2FsbGJhY2ssLi4uYXJncyl7XG5cdFx0aWYgKCh0aGlzLl90eXBlKSAmJiAodGhpcy5fd2ZvKSl7XG5cdFx0XHR2YXIgdXJsID0gdGhpcy5fYmFzZVVybCt0aGlzLl9wcm9kdWN0c1VybCt0aGlzLl90eXBlc1VybCsnLycrdGhpcy5fdHlwZSt0aGlzLl9sb2NhdGlvbnNVcmwrJy8nK3RoaXMuX3dmb1xuXHRcdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwpXG5cdFx0XHR2YXIganNvbiA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblx0XHRcdGxldCBwcm9kdWN0cztcblx0XHRcdHRoaXMuX3Byb2R1Y3RMaXN0aW5nID0ganNvbjtcblxuXHRcdFx0aWYgKHRoaXMuX2lkeCAhPT0gZmFsc2UpIHsgIHByb2R1Y3RzID0gYXdhaXQgdGhpcy5ieUluZGV4KCkgfVxuXHRcdFx0ZWxzZSB7IHByb2R1Y3RzID0gYXdhaXQgdGhpcy5ieVN1YnNldCgpIH1cblx0XHRcdGlmIChjYWxsYmFjaykgeyBjYWxsYmFjayhwcm9kdWN0cywuLi5hcmdzKTsgfVxuXHRcdFx0ZWxzZSB7IHJldHVybiBwcm9kdWN0czsgfVxuXHRcdH1cblx0XHRlbHNlIHsgcmV0dXJuIGZhbHNlOyB9XG5cdH1cbn1cbiovIiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0aWYoX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSkge1xuXHRcdHJldHVybiBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0obW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCIvLyBtb2R1bGUgZXhwb3J0cyBtdXN0IGJlIHJldHVybmVkIGZyb20gcnVudGltZSBzbyBlbnRyeSBpbmxpbmluZyBpcyBkaXNhYmxlZFxuLy8gc3RhcnR1cFxuLy8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG5yZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyg0MjMpO1xuIiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCkiLCIvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSAoZXhwb3J0cykgPT4ge1xuXHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcblx0fVxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xufTsiXSwic291cmNlUm9vdCI6IiJ9