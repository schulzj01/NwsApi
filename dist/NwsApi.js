window.NwsApi=(()=>{"use strict";var t={423:(t,e,r)=>{r.r(e),r.d(e,{Alert:()=>i,Forecast:()=>a,Product:()=>l});class s{constructor(){}async retryFetch(t,e,r,s){try{let r=await fetch(t,e);if(r.ok)return r;throw new Error("Request to "+t+" failed: "+r.statusText)}catch(i){if(1===s)throw i;return await this.sleep(r),await this.retryFetch(t,e,r,s-1)}}async retryFetchAllJson(t,e,r,s){return await Promise.all(t.map((async t=>(await this.retryFetch(t,e,r,s)).json())))}async sleep(t){return new Promise((e=>setTimeout(e,t)))}buildGetUrl(t,e){let r=t+"?";for(let[t,s]of Object.entries(e))if(null!==s){let e=t,i="";i=Array.isArray(s)?s.join(","):s.toString(),r+="&"+e+"="+i}return r=encodeURI(r),r}}class i extends s{constructor(t,e){super(),this._queryUrl="https://api.weather.gov/alerts",this._requestRetryLimit=4,this._requestRetryTimeout=4e3,this._filters={active:null,start:null,end:null,status:null,message_type:null,event:null,code:null,region_type:null,point:null,region:null,area:null,zone:null,urgency:null,certainty:null,severity:null,limit:null,cursor:null,product:null,siteid:null,zone:null,county:null,latlon:null},this.returnObj={updated:null,features:null},this._filters=Object.assign(this._filters,t)}async getAll(t,...e){let r=this.buildGetUrl(this._queryUrl,this._filters);try{const t=await this.retryFetch(r,null,this._requestRetryTimeout,this._requestRetryLimit);let e=await t.json();this.returnObj.updated=new Date(e.updated),this.returnObj.features=e.features}catch{console.error("NWS API Unavailable or Bad Request: "+r),this.returnObj=!1}if(!t)return this.returnObj;t(this.returnObj,...e)}}class a extends s{constructor(t,e){super(),this._baseUrl="https://api.weather.gov/",this._pointsUrl="points/",this._gridpointsUrl="gridpoints/",this._fcstHourlyUrl="forecast/hourly",this._fcstSummaryUrl="forecast",this._requestRetryLimit=4,this._requestRetryTimeout=4e3,this._lat=t,this._lon=e,this._metaData=null,this._rawForecast=null,this._summaryForecast=null,this._hourlyForecast=null}async getRawForecast(t,...e){if(this._rawForecast||await this.queryRawForecast(),!t)return this._rawForecast;t(json,...e)}async getHourlyForecast(t,...e){if(this._hourlyForecast||await this.queryHourlyForecast(),!t)return this._hourlyForecast;t(json,...e)}async getSummaryForecast(t,...e){if(this._summaryForecast||await this.querySummaryForecast(),!t)return this._summaryForecast;t(json,...e)}async getMetaData(){return this._metaData||await this.queryPointMetadata(),this._metaData}get gridX(){return this._metaData.properties.gridX}get gridY(){return this._metaData.properties.gridY}get cwa(){return this._metaData.properties.cwa}async queryPointMetadata(){var t=this._baseUrl+this._pointsUrl+this._lat+","+this._lon;const e=await this.retryFetch(t,null,this._requestRetryTimeout,this._requestRetryLimit);this._metaData=await e.json()}async queryRawForecast(t,...e){this._metaData||await this.queryPointMetadata();var r=this._baseUrl+this._gridpointsUrl+this.cwa+"/"+this.gridX+","+this.gridY;const s=await this.retryFetch(r,null,this._requestRetryTimeout,this._requestRetryLimit),i=await s.json();this._rawForecast=i}async queryHourlyForecast(t,...e){this._metaData||await this.queryPointMetadata();var r=this._baseUrl+this._gridpointsUrl+this.cwa+"/"+this.gridX+","+this.gridY+"/"+this._fcstHourlyUrl;const s=await this.retryFetch(r,null,this._requestRetryTimeout,this._requestRetryLimit),i=await s.json();this._hourlyForecast=i}async querySummaryForecast(t,...e){this._metaData||await this.queryPointMetadata();var r=this._baseUrl+this._gridpointsUrl+this.cwa+"/"+this.gridX+","+this.gridY+"/"+this._fcstSummaryUrl;const s=await this.retryFetch(r,null,this._requestRetryTimeout,this._requestRetryLimit),i=await s.json();this._summaryForecast=i}async getForecasts(t,e,...r){let s={};if(t.includes("raw")&&(s.raw=await this.getRawForecast()),t.includes("hourly")&&(s.hourly=await this.getHourlyForecast()),t.includes("summary")&&(s.summary=await this.getSummaryForecast()),!e)return s;e(s,...r)}async getRawWeatherDataBetweenPeriods(t,e,r){this._rawForecast||await this.getRawForecast();let s=this._rawForecast.properties[t].values,i=[],a=[],l=!1;return"quantitativePrecipitation"==t&&(l="split"),s.forEach((t=>{i=i.concat(this.hourlyForecastFromRaw(t,l))})),a=i.filter((t=>{if(t.startDate>=e&&t.endDate<=r)return!0})),a}}class l extends s{constructor(t,e){super(),this._queryUrl="https://api.weather.gov/products",this._requestRetryLimit=4,this._requestRetryTimeout=1e3,this._getAllLimit=25,this._filters={location:null,start:null,end:null,office:null,wmoid:null,type:null,limit:null},this._productListing=!1,this.returnObj={updated:null,features:null},this._filters=Object.assign(this._filters,t)}async getFullProductListing(){let t=this.buildGetUrl(this._queryUrl,this._filters);try{const e=await this.retryFetch(t,null,this._requestRetryTimeout,this._requestRetryLimit);let r=await e.json();return this._productListing=r["@graph"],this._productListing}catch{throw new Error("NWS API Unavailable or Bad Request: "+t)}}async getAll(t,...e){let r=[];r=this._productListing?this._productListing:await this.getFullProductListing(),this._filters.limit||(r=r.slice(0,this._getAllLimit));let s=await this.getProductsFulltext(r);if(!t)return s;t(s,...e)}async getProductsFulltext(t){let e=[];if(0!==t.length){let r=t.map((t=>t["@id"]));e=await this.retryFetchAllJson(r,null,this._requestRetryTimeout,this._requestRetryLimit)}return e}}}},e={};function r(s){if(e[s])return e[s].exports;var i=e[s]={exports:{}};return t[s](i,i.exports,r),i.exports}return r.d=(t,e)=>{for(var s in e)r.o(e,s)&&!r.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r(423)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9Od3NBcGkvLi9zcmMvanMvQmFzZS5qcyIsIndlYnBhY2s6Ly9Od3NBcGkvLi9zcmMvanMvQWxlcnQuanMiLCJ3ZWJwYWNrOi8vTndzQXBpLy4vc3JjL2pzL0ZvcmVjYXN0LmpzIiwid2VicGFjazovL053c0FwaS8uL3NyYy9qcy9Qcm9kdWN0LmpzIiwid2VicGFjazovL053c0FwaS93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9Od3NBcGkvd2VicGFjay9zdGFydHVwIiwid2VicGFjazovL053c0FwaS93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vTndzQXBpL3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vTndzQXBpL3dlYnBhY2svcnVudGltZS9tYWtlIG5hbWVzcGFjZSBvYmplY3QiXSwibmFtZXMiOlsiQmFzZSIsInVybCIsIm9wdGlvbnMiLCJ3YWl0IiwibnVtVHJpZXMiLCJyZXNwb25zZSIsImZldGNoIiwib2siLCJFcnJvciIsInN0YXR1c1RleHQiLCJlcnIiLCJ0aGlzIiwic2xlZXAiLCJyZXRyeUZldGNoIiwidXJscyIsIlByb21pc2UiLCJhbGwiLCJtYXAiLCJhc3luYyIsImpzb24iLCJtcyIsInJlc29sdmUiLCJzZXRUaW1lb3V0IiwiYmFzZVVybCIsInBhcmFtZXRlcnMiLCJrIiwidiIsIk9iamVjdCIsImVudHJpZXMiLCJwYXJtIiwidmFsIiwiQXJyYXkiLCJpc0FycmF5Iiwiam9pbiIsInRvU3RyaW5nIiwiZW5jb2RlVVJJIiwiQWxlcnQiLCJmaWx0ZXJzIiwic3VwZXIiLCJfcXVlcnlVcmwiLCJfcmVxdWVzdFJldHJ5TGltaXQiLCJfcmVxdWVzdFJldHJ5VGltZW91dCIsIl9maWx0ZXJzIiwiYWN0aXZlIiwic3RhcnQiLCJlbmQiLCJzdGF0dXMiLCJtZXNzYWdlX3R5cGUiLCJldmVudCIsImNvZGUiLCJyZWdpb25fdHlwZSIsInBvaW50IiwicmVnaW9uIiwiYXJlYSIsInpvbmUiLCJ1cmdlbmN5IiwiY2VydGFpbnR5Iiwic2V2ZXJpdHkiLCJsaW1pdCIsImN1cnNvciIsInByb2R1Y3QiLCJzaXRlaWQiLCJjb3VudHkiLCJsYXRsb24iLCJyZXR1cm5PYmoiLCJ1cGRhdGVkIiwiZmVhdHVyZXMiLCJhc3NpZ24iLCJjYWxsYmFjayIsImFyZ3MiLCJidWlsZEdldFVybCIsIkRhdGUiLCJjb25zb2xlIiwiZXJyb3IiLCJGb3JlY2FzdCIsImxhdCIsImxvbiIsIl9iYXNlVXJsIiwiX3BvaW50c1VybCIsIl9ncmlkcG9pbnRzVXJsIiwiX2Zjc3RIb3VybHlVcmwiLCJfZmNzdFN1bW1hcnlVcmwiLCJfbGF0IiwiX2xvbiIsIl9tZXRhRGF0YSIsIl9yYXdGb3JlY2FzdCIsIl9zdW1tYXJ5Rm9yZWNhc3QiLCJfaG91cmx5Rm9yZWNhc3QiLCJxdWVyeVJhd0ZvcmVjYXN0IiwicXVlcnlIb3VybHlGb3JlY2FzdCIsInF1ZXJ5U3VtbWFyeUZvcmVjYXN0IiwicXVlcnlQb2ludE1ldGFkYXRhIiwicHJvcGVydGllcyIsImdyaWRYIiwiZ3JpZFkiLCJjd2EiLCJ0eXBlcyIsImZvcmVjYXN0RGF0YSIsImluY2x1ZGVzIiwiZ2V0UmF3Rm9yZWNhc3QiLCJnZXRIb3VybHlGb3JlY2FzdCIsImdldFN1bW1hcnlGb3JlY2FzdCIsImVsZW1lbnQiLCJzdGFydERhdGUiLCJlbmREYXRlIiwicmF3RmNzdERhdGEiLCJ2YWx1ZXMiLCJob3VybHlGY3N0RGF0YSIsInZhbGlkSG91cmx5RmNzdERhdGEiLCJjYWxjTWV0aG9kIiwiZm9yRWFjaCIsInJhd0Zjc3QiLCJjb25jYXQiLCJob3VybHlGb3JlY2FzdEZyb21SYXciLCJmaWx0ZXIiLCJmY3N0IiwiUHJvZHVjdCIsIl9nZXRBbGxMaW1pdCIsImxvY2F0aW9uIiwib2ZmaWNlIiwid21vaWQiLCJ0eXBlIiwiX3Byb2R1Y3RMaXN0aW5nIiwicHJvZExpc3RpbmdTdWJzZXQiLCJnZXRGdWxsUHJvZHVjdExpc3RpbmciLCJzbGljZSIsInByb2RGdWxsVGV4dHMiLCJnZXRQcm9kdWN0c0Z1bGx0ZXh0IiwicHJvZHVjdExpc3RpbmciLCJwcm9kdWN0VGV4dHMiLCJsZW5ndGgiLCJwcm9kIiwicmV0cnlGZXRjaEFsbEpzb24iLCJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsImQiLCJkZWZpbml0aW9uIiwia2V5IiwibyIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsIm9iaiIsInByb3AiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSJdLCJtYXBwaW5ncyI6IitHQUNlLE1BQU1BLEVBQ3BCLGVBSUEsaUJBQWlCQyxFQUFLQyxFQUFTQyxFQUFNQyxHQUNsQyxJQUNELElBQUlDLFFBQWlCQyxNQUFNTCxFQUFLQyxHQUNoQyxHQUFLRyxFQUFTRSxHQUNKLE9BQU9GLEVBREcsTUFBTSxJQUFJRyxNQUFNLGNBQWNQLEVBQUksWUFBY0ksRUFBU0ksWUFFMUUsTUFBTUMsR0FDVCxHQUFpQixJQUFiTixFQUFrQixNQUFNTSxFQUczQixhQURNQyxLQUFLQyxNQUFNVCxTQUNKUSxLQUFLRSxXQUFXWixFQUFLQyxFQUFTQyxFQUFNQyxFQUFXLElBSy9ELHdCQUF3QlUsRUFBS1osRUFBUUMsRUFBS0MsR0FDekMsYUFBYVcsUUFBUUMsSUFDcEJGLEVBQUtHLEtBQUlDLGdCQUNlUCxLQUFLRSxXQUFXWixFQUFJQyxFQUFRQyxFQUFLQyxJQUN4Q2UsVUFNbkIsWUFBWUMsR0FDVixPQUFPLElBQUlMLFNBQVFNLEdBQVdDLFdBQVdELEVBQVNELEtBS25ELFlBQVlHLEVBQVNDLEdBRXJCLElBQUl2QixFQUFNc0IsRUFBUSxJQUNqQixJQUFLLElBQUtFLEVBQUdDLEtBQU1DLE9BQU9DLFFBQVFKLEdB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RCxRQ2pCZixPQ0ZBRixFQUFvQkssRUFBSSxDQUFDSCxFQUFTSSxLQUNqQyxJQUFJLElBQUlDLEtBQU9ELEVBQ1hOLEVBQW9CUSxFQUFFRixFQUFZQyxLQUFTUCxFQUFvQlEsRUFBRU4sRUFBU0ssSUFDNUVsSCxPQUFPb0gsZUFBZVAsRUFBU0ssRUFBSyxDQUFFRyxZQUFZLEVBQU1DLElBQUtMLEVBQVdDLE1DSjNFUCxFQUFvQlEsRUFBSSxDQUFDSSxFQUFLQyxJQUFTeEgsT0FBT3lILFVBQVVDLGVBQWVDLEtBQUtKLEVBQUtDLEdDQ2pGYixFQUFvQmlCLEVBQUtmLElBQ0gsb0JBQVhnQixRQUEwQkEsT0FBT0MsYUFDMUM5SCxPQUFPb0gsZUFBZVAsRUFBU2dCLE9BQU9DLFlBQWEsQ0FBRUMsTUFBTyxXQUU3RC9ILE9BQU9vSCxlQUFlUCxFQUFTLGFBQWMsQ0FBRWtCLE9BQU8sS0hGaERwQixFQUFvQixNIiwiZmlsZSI6Ik53c0FwaS5qcyIsInNvdXJjZXNDb250ZW50IjpbIlxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQmFzZSB7IFxuXHRjb25zdHJ1Y3Rvcigpe1xuXHR9XG5cbiAgLy9yZXRyeXMgYSBwcm9taXNlIG11bHRpcGxlIHRpbWVzIHdpdGggYSB0aW1lb3V0IGluIG9yZGVyIHRvIGRlYWwgd2l0aCBmYWlsZWQgcmVxdWVzdHMuXG5cdGFzeW5jIHJldHJ5RmV0Y2godXJsLCBvcHRpb25zLCB3YWl0LCBudW1Ucmllcykge1xuICAgIHRyeSB7XG5cdFx0XHRsZXQgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwsIG9wdGlvbnMpO1xuXHRcdFx0aWYgKCFyZXNwb25zZS5vaykgeyB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVlc3QgdG8gJyt1cmwrJyBmYWlsZWQ6ICcgKyByZXNwb25zZS5zdGF0dXNUZXh0KTsgfVxuICAgICAgZWxzZSB7IHJldHVybiByZXNwb25zZTsgfVxuICAgIH0gY2F0Y2goZXJyKSB7XG5cdFx0XHRpZiAobnVtVHJpZXMgPT09IDEpIHsgdGhyb3cgZXJyOyB9XG5cdFx0XHRlbHNlIHsgXG5cdFx0XHRcdGF3YWl0IHRoaXMuc2xlZXAod2FpdCk7XG5cdFx0XHRcdHJldHVybiBhd2FpdCB0aGlzLnJldHJ5RmV0Y2godXJsLCBvcHRpb25zLCB3YWl0LCBudW1UcmllcyAtIDEpO1x0XG5cdFx0XHR9XG4gICAgfVxuXHR9O1xuXG5cdGFzeW5jIHJldHJ5RmV0Y2hBbGxKc29uKHVybHMsb3B0aW9ucyx3YWl0LG51bVRyaWVzKSB7IFxuXHRcdHJldHVybiBhd2FpdCBQcm9taXNlLmFsbChcblx0XHRcdHVybHMubWFwKGFzeW5jIHVybCA9PiB7XG5cdFx0XHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5yZXRyeUZldGNoKHVybCxvcHRpb25zLHdhaXQsbnVtVHJpZXMpO1xuXHRcdFx0XHRyZXR1cm4gcmVzcG9uc2UuanNvbigpO1xuXHRcdFx0fSlcblx0XHQpXG5cdH1cblxuXG5cdGFzeW5jIHNsZWVwKG1zKSB7XG4gIFx0cmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCBtcykpO1xuXHR9O1xuXG5cbiAgLy9CdWlsZCBVUkwgZnJvbSBhbGwgcGFyYW1ldGVyc1xuICBidWlsZEdldFVybChiYXNlVXJsLCBwYXJhbWV0ZXJzKSB7XG5cdFx0Ly9PYmplY3QuZW50cmllcyhvYmopLnNvcnQoKGEsIGIpID0+IGJbMF0ubG9jYWxlQ29tcGFyZShhWzBdKSk7XG5cdFx0bGV0IHVybCA9IGJhc2VVcmwrJz8nO1xuICBcdGZvciAobGV0IFtrLCB2XSBvZiBPYmplY3QuZW50cmllcyhwYXJhbWV0ZXJzKSkge1xuXHQgICAgaWYgKHYgIT09IG51bGwpIHtcbiAgICAgIFx0bGV0IHBhcm0gPSBrO1xuICAgICAgXHRsZXQgdmFsID0gJyc7XG4gICAgICBcdGlmIChBcnJheS5pc0FycmF5KHYpKSB7IHZhbCA9IHYuam9pbignLCcpOyB9XG4gICAgICBcdGVsc2UgeyB2YWwgPSB2LnRvU3RyaW5nKCk7IH1cbiAgICAgIFx0dXJsICs9ICcmJyArIHBhcm0gKyAnPScgKyB2YWw7XG4gICAgXHR9XG5cdFx0fVxuXHRcdHVybCA9IGVuY29kZVVSSSh1cmwpO1xuXHRcdHJldHVybiB1cmw7XG5cdH1cdFxuXG5cblxufSIsImltcG9ydCBCYXNlIGZyb20gJy4vQmFzZS5qcyc7XG5cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQWxlcnQgZXh0ZW5kcyBCYXNlICB7XG5cdFxuXHRjb25zdHJ1Y3RvcihmaWx0ZXJzLG9wdGlvbnMpIHtcblx0XHRzdXBlcigpO1xuXHRcdHRoaXMuX3F1ZXJ5VXJsID0gJ2h0dHBzOi8vYXBpLndlYXRoZXIuZ292L2FsZXJ0cyc7XG5cdFx0Ly90aGlzLl9hY3RpdmVVcmwgPSAnL2FjdGl2ZSdcblx0XHQvL3RoaXMuX3pvbmVVcmwgPSAnL3pvbmUnO1xuXHRcdHRoaXMuX3JlcXVlc3RSZXRyeUxpbWl0ID0gNDtcblx0XHR0aGlzLl9yZXF1ZXN0UmV0cnlUaW1lb3V0ID0gNDAwMDsgLy80MDAwO1xuXHRcdHRoaXMuX2ZpbHRlcnMgPSB7XG5cdFx0XHRhY3RpdmUgOiBudWxsLFxuXHRcdFx0c3RhcnQgOiBudWxsLFxuXHRcdFx0ZW5kIDogbnVsbCxcblx0XHRcdHN0YXR1cyA6IG51bGwsXG5cdFx0XHRtZXNzYWdlX3R5cGUgOiBudWxsLFxuXHRcdFx0ZXZlbnQgOiBudWxsLFxuXHRcdFx0Y29kZSA6IG51bGwsXG5cdFx0XHRyZWdpb25fdHlwZSA6IG51bGwsXG5cdFx0XHRwb2ludCA6IG51bGwsXG5cdFx0XHRyZWdpb24gOiBudWxsLFxuXHRcdFx0YXJlYSA6IG51bGwsXG5cdFx0XHR6b25lIDogbnVsbCxcblx0XHRcdHVyZ2VuY3kgOiBudWxsLFxuXHRcdFx0Y2VydGFpbnR5IDogbnVsbCxcblx0XHRcdHNldmVyaXR5IDogbnVsbCxcblx0XHRcdGxpbWl0IDogbnVsbCxcblx0XHRcdGN1cnNvciA6IG51bGwsXG5cdFx0XHRwcm9kdWN0IDogbnVsbCxcblx0XHRcdHNpdGVpZCA6IG51bGwsXG5cdFx0XHR6b25lIDogbnVsbCxcblx0XHRcdGNvdW50eSA6IG51bGwsICBcblx0XHRcdGxhdGxvbiA6IG51bGwsXG5cdFx0XHQvL25ld3Byb3AgOiBudWxsLFxuXHRcdH1cblx0XHR0aGlzLnJldHVybk9iaiA9IHtcblx0XHRcdHVwZGF0ZWQgOiBudWxsLFxuXHRcdFx0ZmVhdHVyZXMgOiBudWxsXG5cdFx0fVxuXHRcdHRoaXMuX2ZpbHRlcnMgPSBPYmplY3QuYXNzaWduKHRoaXMuX2ZpbHRlcnMsIGZpbHRlcnMpOyAgIC8vIENvdWxkIGFsc28ganVzdCBkbyBcImFkZGVkQmFjay5jb21tZW50cyA9IENvbW1lbnRzLmNvbW1lbnRzO1wiIGlmIHlvdSBvbmx5IGNhcmUgYWJvdXQgdGhpcyBvbmUgcHJvcGVydHlcblx0fTtcblxuXHRhc3luYyBnZXRBbGwoY2FsbGJhY2ssLi4uYXJncyl7XG5cdFx0bGV0IHVybCA9IHRoaXMuYnVpbGRHZXRVcmwodGhpcy5fcXVlcnlVcmwsdGhpcy5fZmlsdGVycyk7XG5cblx0XHR0cnkge1xuXHRcdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLnJldHJ5RmV0Y2godXJsLCBudWxsLCB0aGlzLl9yZXF1ZXN0UmV0cnlUaW1lb3V0LCB0aGlzLl9yZXF1ZXN0UmV0cnlMaW1pdCk7XG5cdFx0XHRsZXQganNvbiA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblx0XHRcdHRoaXMucmV0dXJuT2JqLnVwZGF0ZWQgPSBuZXcgRGF0ZShqc29uLnVwZGF0ZWQpO1xuXHRcdFx0dGhpcy5yZXR1cm5PYmouZmVhdHVyZXMgPSBqc29uLmZlYXR1cmVzO1xuXHRcdH0gXG5cdFx0Y2F0Y2gge1xuXHRcdFx0Y29uc29sZS5lcnJvcignTldTIEFQSSBVbmF2YWlsYWJsZSBvciBCYWQgUmVxdWVzdDogJyArIHVybCk7IFxuXHRcdFx0dGhpcy5yZXR1cm5PYmogPSBmYWxzZTtcblx0XHR9XG5cdFx0aWYgKGNhbGxiYWNrKSB7IGNhbGxiYWNrKHRoaXMucmV0dXJuT2JqLC4uLmFyZ3MpOyB9XG5cdFx0ZWxzZSB7IHJldHVybiB0aGlzLnJldHVybk9iajsgfVx0XHRcdFxuXHR9O1xuXG59XG4iLCJpbXBvcnQgQmFzZSBmcm9tICcuL0Jhc2UuanMnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JlY2FzdCBleHRlbmRzIEJhc2UgIHtcblx0Y29uc3RydWN0b3IobGF0LGxvbikge1xuXHRcdHN1cGVyKCk7XG5cdFx0dGhpcy5fYmFzZVVybCA9ICdodHRwczovL2FwaS53ZWF0aGVyLmdvdi8nO1xuXHRcdHRoaXMuX3BvaW50c1VybCA9ICdwb2ludHMvJztcblx0XHR0aGlzLl9ncmlkcG9pbnRzVXJsID0gJ2dyaWRwb2ludHMvJztcblx0XHR0aGlzLl9mY3N0SG91cmx5VXJsID0gJ2ZvcmVjYXN0L2hvdXJseSc7XG5cdFx0dGhpcy5fZmNzdFN1bW1hcnlVcmwgPSAnZm9yZWNhc3QnO1xuXG5cdFx0dGhpcy5fcmVxdWVzdFJldHJ5TGltaXQgPSA0O1xuXHRcdHRoaXMuX3JlcXVlc3RSZXRyeVRpbWVvdXQgPSA0MDAwOyBcblx0XHR0aGlzLl9sYXQgPSBsYXQ7XG5cdFx0dGhpcy5fbG9uID0gbG9uO1xuXG5cdFx0dGhpcy5fbWV0YURhdGEgPSBudWxsO1xuXHRcdHRoaXMuX3Jhd0ZvcmVjYXN0ID0gbnVsbDtcblx0XHR0aGlzLl9zdW1tYXJ5Rm9yZWNhc3QgPSBudWxsO1xuXHRcdHRoaXMuX2hvdXJseUZvcmVjYXN0ID0gbnVsbDtcblx0fVxuXG5cdGFzeW5jIGdldFJhd0ZvcmVjYXN0KGNhbGxiYWNrLC4uLmFyZ3Mpe1xuXHRcdGlmICghdGhpcy5fcmF3Rm9yZWNhc3QpeyBhd2FpdCB0aGlzLnF1ZXJ5UmF3Rm9yZWNhc3QoKTsgfVxuXHRcdGlmIChjYWxsYmFjaykgIHsgY2FsbGJhY2soanNvbiwuLi5hcmdzKTsgfVxuXHRcdGVsc2UgeyByZXR1cm4gdGhpcy5fcmF3Rm9yZWNhc3Q7IH1cblx0fVxuXHRhc3luYyBnZXRIb3VybHlGb3JlY2FzdChjYWxsYmFjaywuLi5hcmdzKXtcblx0XHRpZiAoIXRoaXMuX2hvdXJseUZvcmVjYXN0KXsgYXdhaXQgdGhpcy5xdWVyeUhvdXJseUZvcmVjYXN0KCk7IH1cblx0XHRpZiAoY2FsbGJhY2spICB7IGNhbGxiYWNrKGpzb24sLi4uYXJncyk7IH1cblx0XHRlbHNlIHsgcmV0dXJuIHRoaXMuX2hvdXJseUZvcmVjYXN0OyB9XG5cdH1cblx0YXN5bmMgZ2V0U3VtbWFyeUZvcmVjYXN0KGNhbGxiYWNrLC4uLmFyZ3Mpe1xuXHRcdGlmICghdGhpcy5fc3VtbWFyeUZvcmVjYXN0KXsgYXdhaXQgdGhpcy5xdWVyeVN1bW1hcnlGb3JlY2FzdCgpOyB9XG5cdFx0aWYgKGNhbGxiYWNrKSAgeyBjYWxsYmFjayhqc29uLC4uLmFyZ3MpOyB9XG5cdFx0ZWxzZSB7IHJldHVybiB0aGlzLl9zdW1tYXJ5Rm9yZWNhc3Q7IH1cblx0fVxuXHRhc3luYyBnZXRNZXRhRGF0YSgpe1xuXHRcdGlmICghdGhpcy5fbWV0YURhdGEpeyBhd2FpdCB0aGlzLnF1ZXJ5UG9pbnRNZXRhZGF0YSgpO1x0fVxuXHRcdHJldHVybiB0aGlzLl9tZXRhRGF0YTsgXG5cdH1cblx0XG5cdGdldCBncmlkWCgpIHsgcmV0dXJuIHRoaXMuX21ldGFEYXRhLnByb3BlcnRpZXMuZ3JpZFg7IH1cblx0Z2V0IGdyaWRZKCkgeyByZXR1cm4gdGhpcy5fbWV0YURhdGEucHJvcGVydGllcy5ncmlkWTsgfVxuXHRnZXQgY3dhKCkgeyByZXR1cm4gdGhpcy5fbWV0YURhdGEucHJvcGVydGllcy5jd2E7IH1cblxuXHRhc3luYyBxdWVyeVBvaW50TWV0YWRhdGEoKSB7XG5cdFx0dmFyIHNlbGYgPSB0aGlzO1xuXHRcdHZhciB1cmwgPSB0aGlzLl9iYXNlVXJsK3RoaXMuX3BvaW50c1VybCt0aGlzLl9sYXQrJywnK3RoaXMuX2xvbjtcblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMucmV0cnlGZXRjaCh1cmwsIG51bGwsIHRoaXMuX3JlcXVlc3RSZXRyeVRpbWVvdXQsIHRoaXMuX3JlcXVlc3RSZXRyeUxpbWl0KTtcblx0XHR0aGlzLl9tZXRhRGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblx0fTtcblx0YXN5bmMgcXVlcnlSYXdGb3JlY2FzdChjYWxsYmFjaywuLi5hcmdzKSB7XG5cdFx0aWYgKCF0aGlzLl9tZXRhRGF0YSl7IGF3YWl0IHRoaXMucXVlcnlQb2ludE1ldGFkYXRhKCk7XHR9XG5cdFx0dmFyIHVybCA9IHRoaXMuX2Jhc2VVcmwrdGhpcy5fZ3JpZHBvaW50c1VybCt0aGlzLmN3YSsnLycrdGhpcy5ncmlkWCsnLCcrdGhpcy5ncmlkWVxuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5yZXRyeUZldGNoKHVybCwgbnVsbCwgdGhpcy5fcmVxdWVzdFJldHJ5VGltZW91dCwgdGhpcy5fcmVxdWVzdFJldHJ5TGltaXQpXG5cdFx0Y29uc3QganNvbiA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblx0XHR0aGlzLl9yYXdGb3JlY2FzdCA9IGpzb24gXG5cdH1cblx0YXN5bmMgcXVlcnlIb3VybHlGb3JlY2FzdChjYWxsYmFjaywuLi5hcmdzKSB7XG5cdFx0aWYgKCF0aGlzLl9tZXRhRGF0YSl7IGF3YWl0IHRoaXMucXVlcnlQb2ludE1ldGFkYXRhKCk7XHR9XG5cdFx0dmFyIHVybCA9IHRoaXMuX2Jhc2VVcmwrdGhpcy5fZ3JpZHBvaW50c1VybCt0aGlzLmN3YSsnLycrdGhpcy5ncmlkWCsnLCcrdGhpcy5ncmlkWSsnLycrdGhpcy5fZmNzdEhvdXJseVVybDtcblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMucmV0cnlGZXRjaCh1cmwsIG51bGwsIHRoaXMuX3JlcXVlc3RSZXRyeVRpbWVvdXQsIHRoaXMuX3JlcXVlc3RSZXRyeUxpbWl0KVxuXHRcdGNvbnN0IGpzb24gPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cdFx0dGhpcy5faG91cmx5Rm9yZWNhc3QgPSBqc29uIFxuXHR9XG5cdGFzeW5jIHF1ZXJ5U3VtbWFyeUZvcmVjYXN0KGNhbGxiYWNrLC4uLmFyZ3MpIHtcblx0XHRpZiAoIXRoaXMuX21ldGFEYXRhKXsgYXdhaXQgdGhpcy5xdWVyeVBvaW50TWV0YWRhdGEoKTtcdH1cblx0XHR2YXIgdXJsID0gdGhpcy5fYmFzZVVybCt0aGlzLl9ncmlkcG9pbnRzVXJsK3RoaXMuY3dhKycvJyt0aGlzLmdyaWRYKycsJyt0aGlzLmdyaWRZKycvJyt0aGlzLl9mY3N0U3VtbWFyeVVybDtcblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMucmV0cnlGZXRjaCh1cmwsIG51bGwsIHRoaXMuX3JlcXVlc3RSZXRyeVRpbWVvdXQsIHRoaXMuX3JlcXVlc3RSZXRyeUxpbWl0KVxuXHRcdGNvbnN0IGpzb24gPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cdFx0dGhpcy5fc3VtbWFyeUZvcmVjYXN0ID0ganNvbiBcblx0fVxuXHRhc3luYyBnZXRGb3JlY2FzdHModHlwZXMsY2FsbGJhY2ssLi4uYXJncykge1xuXHRcdGxldCBmb3JlY2FzdERhdGEgPSB7fVxuXHRcdGlmICh0eXBlcy5pbmNsdWRlcygncmF3JykpIHsgZm9yZWNhc3REYXRhWydyYXcnXSA9IGF3YWl0IHRoaXMuZ2V0UmF3Rm9yZWNhc3QoKTsgfVxuXHRcdGlmICh0eXBlcy5pbmNsdWRlcygnaG91cmx5JykpIHsgZm9yZWNhc3REYXRhWydob3VybHknXSA9IGF3YWl0IHRoaXMuZ2V0SG91cmx5Rm9yZWNhc3QoKTsgfVxuXHRcdGlmICh0eXBlcy5pbmNsdWRlcygnc3VtbWFyeScpKSB7IGZvcmVjYXN0RGF0YVsnc3VtbWFyeSddID0gYXdhaXQgdGhpcy5nZXRTdW1tYXJ5Rm9yZWNhc3QoKTsgfVxuXHRcdGlmIChjYWxsYmFjaykgIHsgY2FsbGJhY2soZm9yZWNhc3REYXRhLC4uLmFyZ3MpOyB9XG5cdFx0ZWxzZSB7IHJldHVybiBmb3JlY2FzdERhdGEgfVxuXHR9XG5cblx0YXN5bmMgZ2V0UmF3V2VhdGhlckRhdGFCZXR3ZWVuUGVyaW9kcyhlbGVtZW50LHN0YXJ0RGF0ZSxlbmREYXRlKXtcblx0XHRpZiAoIXRoaXMuX3Jhd0ZvcmVjYXN0KXsgYXdhaXQgdGhpcy5nZXRSYXdGb3JlY2FzdCgpO1x0fVxuXHRcdGxldCByYXdGY3N0RGF0YSA9IHRoaXMuX3Jhd0ZvcmVjYXN0LnByb3BlcnRpZXNbZWxlbWVudF0udmFsdWVzO1xuXHRcdGxldCBob3VybHlGY3N0RGF0YSA9IFtdO1xuXHRcdGxldCB2YWxpZEhvdXJseUZjc3REYXRhID0gW107XG5cdFx0bGV0IGNhbGNNZXRob2QgPSBmYWxzZTtcblx0XHRpZiAoZWxlbWVudCA9PSAncXVhbnRpdGF0aXZlUHJlY2lwaXRhdGlvbicpIHsgY2FsY01ldGhvZCA9ICdzcGxpdCc7IH1cblx0XHRyYXdGY3N0RGF0YS5mb3JFYWNoKCByYXdGY3N0ID0+IHtcblx0XHRcdFxuXHRcdFx0aG91cmx5RmNzdERhdGEgPSBob3VybHlGY3N0RGF0YS5jb25jYXQodGhpcy5ob3VybHlGb3JlY2FzdEZyb21SYXcocmF3RmNzdCxjYWxjTWV0aG9kKSk7XG5cdFx0fSk7XG5cdFx0XG5cdFx0dmFsaWRIb3VybHlGY3N0RGF0YSA9IGhvdXJseUZjc3REYXRhLmZpbHRlcigoZmNzdCkgPT4ge1xuXHRcdFx0aWYgKChmY3N0LnN0YXJ0RGF0ZSA+PSBzdGFydERhdGUpICYmIChmY3N0LmVuZERhdGUgPD0gZW5kRGF0ZSkpIHsgcmV0dXJuIHRydWU7IH1cblx0XHR9KVxuXHRcdHJldHVybiB2YWxpZEhvdXJseUZjc3REYXRhO1xuXHR9XG5cdFxuLypcdGhvdXJseVRpbWVzQmV0d2VlbihzdGFydERhdGUsZW5kRGF0ZSl7XG5cdFx0bGV0IGRlc2lyZWRGb3JlY2FzdERhdGVzID0gW107XG5cdFx0bGV0IGhvdXJseURhdGUgPSBzdGFydERhdGU7IFxuXHRcdHdoaWxlIChob3VybHlEYXRlIDwgZW5kRGF0ZSl7XG5cdFx0XHRkZXNpcmVkRm9yZWNhc3REYXRlcy5wdXNoKG5ldyBEYXRlKGhvdXJseURhdGUpKVxuXHRcdFx0aG91cmx5RGF0ZSA9IG5ldyBEYXRlKGhvdXJseURhdGUuc2V0SG91cnMoaG91cmx5RGF0ZS5nZXRIb3VycygpICsgMSkpO1xuXHRcdH1cblx0XHRyZXR1cm4gZGVzaXJlZEZvcmVjYXN0RGF0ZXM7XG5cdH0qL1xuXG4vKlx0aG91cmx5Rm9yZWNhc3RGcm9tUmF3KHd4RGF0YSxjYWxjKXtcblx0XHRsZXQgd3hEYXRhVGltZVBlcmlvZCA9IHRoaXMuZGVjb2RlUmF3Rm9yZWNhc3RUaW1lUGVyaW9kKHd4RGF0YS52YWxpZFRpbWUpXG5cdFx0bGV0IGhvdXJseUZvcmVjYXN0RGF0YSA9IFtdO1xuXHRcdGxldCBob3VybHlEYXRlID0gd3hEYXRhVGltZVBlcmlvZC5zdGFydERhdGU7XG5cdFx0bGV0IGhvdXJseVZhbHVlO1xuXHRcdGlmIChjYWxjID09ICdzcGxpdCcpIHsgaG91cmx5VmFsdWUgPSB3eERhdGEudmFsdWUgLyB3eERhdGFUaW1lUGVyaW9kLmR1cmF0aW9uOyB9XG5cdFx0ZWxzZSB7IGhvdXJseVZhbHVlID0gd3hEYXRhLnZhbHVlOyB9XG5cdFx0d2hpbGUgKGhvdXJseURhdGUgPCB3eERhdGFUaW1lUGVyaW9kLmVuZERhdGUpe1xuXHRcdFx0bGV0IGhvdXJseVN0YXJ0RGF0ZSA9IG5ldyBEYXRlKGhvdXJseURhdGUpO1xuXHRcdFx0aG91cmx5RGF0ZSA9IG5ldyBEYXRlKGhvdXJseURhdGUuc2V0SG91cnMoaG91cmx5RGF0ZS5nZXRIb3VycygpICsgMSkpXG5cdFx0XHRsZXQgaG91cmx5RW5kRGF0ZSA9IG5ldyBEYXRlKGhvdXJseURhdGUpOyBcblx0XHRcdGhvdXJseUZvcmVjYXN0RGF0YS5wdXNoKHtcblx0XHRcdFx0c3RhcnREYXRlIDogaG91cmx5U3RhcnREYXRlLFxuXHRcdFx0XHRlbmREYXRlIDogaG91cmx5RW5kRGF0ZSxcblx0XHRcdFx0dmFsdWUgOiBob3VybHlWYWx1ZVxuXHRcdFx0fSlcblx0XHR9XG5cdFx0cmV0dXJuIGhvdXJseUZvcmVjYXN0RGF0YTtcblx0fVxuXHRcblxuXHRkZWNvZGVSYXdGb3JlY2FzdFRpbWVQZXJpb2QodmFsaWRUaW1lKXtcblx0XHRsZXQgc3RhcnQgPSB2YWxpZFRpbWUuc3BsaXQoJy8nKVswXTtcblx0XHRsZXQgZHVyYXRpb24gPSB2YWxpZFRpbWUuc3BsaXQoJy8nKVsxXTtcblx0XHRkdXJhdGlvbiA9IHBhcnNlSW50KGR1cmF0aW9uLnN1YnN0cmluZyhkdXJhdGlvbi5sYXN0SW5kZXhPZihcIlRcIikgKyAxLGR1cmF0aW9uLmxhc3RJbmRleE9mKFwiSFwiKSkpXG5cdFx0bGV0IHN0YXJ0RGF0ZSA9IG5ldyBEYXRlKHN0YXJ0KTtcblx0XHRsZXQgZW5kRGF0ZSA9IG5ldyBEYXRlKHN0YXJ0KTtcblx0XHRlbmREYXRlLnNldEhvdXJzKGVuZERhdGUuZ2V0SG91cnMoKStkdXJhdGlvbik7XG5cdFx0cmV0dXJuIHtcInN0YXJ0RGF0ZVwiOiBzdGFydERhdGUsIFwiZW5kRGF0ZVwiOiBlbmREYXRlLCBcImR1cmF0aW9uXCI6IGR1cmF0aW9uIH07XG5cdH0qL1xuXG5cblxuXHRcbi8vXHRcdGNvbnN0IHN1bW1hcnlGY3N0ID0gYXdhaXQgdGhpcy5zdW1tYXJoeUZvcmVjYXN0KCk7XG4vL1x0XHRpZiAoIXRoaXMuX21ldGFEYXRhKXsgYXdhaXQgdGhpcy5hcGlQb2ludE1ldGFEYXRhKCk7XHR9XG4vL1x0XHR2YXIgdXJsID0gdGhpcy5fYmFzZVVybCt0aGlzLl9ncmlkcG9pbnRzVXJsK3RoaXMuX2N3YSsnLycrdGhpcy5fZ3JpZFgrJywnK3RoaXMuX2dyaWRZKycvJyt0aGlzLl9mY3N0U3VtbWFyeVVybDtcbi8vXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsKVxuLy9cdFx0Y29uc3QganNvbiA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbi8vXHRcdGNhbGxiYWNrKGpzb24sLi4uYXJncylcbi8vXHR9XG5cbn0iLCJpbXBvcnQgQmFzZSBmcm9tICcuL0Jhc2UuanMnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQcm9kdWN0IGV4dGVuZHMgQmFzZSAge1xuXHRcblx0Y29uc3RydWN0b3IoZmlsdGVycyxvcHRpb25zKSB7XG5cdFx0c3VwZXIoKTtcblx0XHR0aGlzLl9xdWVyeVVybCA9ICdodHRwczovL2FwaS53ZWF0aGVyLmdvdi9wcm9kdWN0cyc7XG5cdFx0Ly90aGlzLl9hY3RpdmVVcmwgPSAnL2FjdGl2ZSdcblx0XHQvL3RoaXMuX3pvbmVVcmwgPSAnL3pvbmUnO1xuXHRcdHRoaXMuX3JlcXVlc3RSZXRyeUxpbWl0ID0gNDtcblx0XHR0aGlzLl9yZXF1ZXN0UmV0cnlUaW1lb3V0ID0gMTAwMDsgLy80MDAwO1xuXHRcdHRoaXMuX2dldEFsbExpbWl0ID0gMjU7XG5cdFx0dGhpcy5fZmlsdGVycyA9IHtcblx0XHRcdGxvY2F0aW9uIDogbnVsbCxcblx0XHRcdHN0YXJ0IDogbnVsbCxcblx0XHRcdGVuZCA6IG51bGwsXG5cdFx0XHRvZmZpY2UgOiBudWxsLFxuXHRcdFx0d21vaWQgOiBudWxsLFxuXHRcdFx0dHlwZSA6IG51bGwsXG5cdFx0XHRsaW1pdCA6IG51bGwsXG5cdFx0fVxuXG5cdFx0dGhpcy5fcHJvZHVjdExpc3RpbmcgPSBmYWxzZTtcblxuXHRcdHRoaXMucmV0dXJuT2JqID0ge1xuXHRcdFx0dXBkYXRlZCA6IG51bGwsXG5cdFx0XHRmZWF0dXJlcyA6IG51bGxcblx0XHR9XG5cdFx0dGhpcy5fZmlsdGVycyA9IE9iamVjdC5hc3NpZ24odGhpcy5fZmlsdGVycywgZmlsdGVycyk7ICAgLy8gQ291bGQgYWxzbyBqdXN0IGRvIFwiYWRkZWRCYWNrLmNvbW1lbnRzID0gQ29tbWVudHMuY29tbWVudHM7XCIgaWYgeW91IG9ubHkgY2FyZSBhYm91dCB0aGlzIG9uZSBwcm9wZXJ0eVxuXHR9O1xuXG5cblx0YXN5bmMgZ2V0RnVsbFByb2R1Y3RMaXN0aW5nKCl7XG5cdFx0bGV0IHVybCA9IHRoaXMuYnVpbGRHZXRVcmwodGhpcy5fcXVlcnlVcmwsdGhpcy5fZmlsdGVycyk7XG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5yZXRyeUZldGNoKHVybCwgbnVsbCwgdGhpcy5fcmVxdWVzdFJldHJ5VGltZW91dCwgdGhpcy5fcmVxdWVzdFJldHJ5TGltaXQpO1xuXHRcdFx0bGV0IGpzb24gPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cdFx0XHR0aGlzLl9wcm9kdWN0TGlzdGluZyA9IGpzb25bJ0BncmFwaCddO1x0XG5cdFx0XHRyZXR1cm4gdGhpcy5fcHJvZHVjdExpc3Rpbmc7XG5cdFx0fSBcblx0XHRjYXRjaCB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ05XUyBBUEkgVW5hdmFpbGFibGUgb3IgQmFkIFJlcXVlc3Q6ICcgKyB1cmwpOyBcblx0XHRcdC8vdGhpcy5fcHJvZHVjdExpc3RpbmcgPSBmYWxzZTtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cdFx0Ly9pZiAoY2FsbGJhY2spIHsgY2FsbGJhY2sodGhpcy5yZXR1cm5PYmosLi4uYXJncyk7IH1cblx0XHQvL2Vsc2UgeyByZXR1cm4gdGhpcy5yZXR1cm5PYmo7IH1cdFx0XHRcblx0fTtcblxuXHQvLyAvL1JldHVybnMgdGhlIG1vc3QgcmVjZW50IHByb2R1Y3RzIGdpdmVuIGEgdG90YWwgbnVtYmVyIHRvIGdvIGJhY2suXG5cdC8vIGFzeW5jIGdldE1vc3RSZWNlbnQobnVtUHJvZHVjdHMgPSAxLGNhbGxiYWNrLC4uLmFyZ3Mpe1xuXHQvLyBcdC8vTWFrZSBzdXJlIHdlJ3JlIG5vdCByZXF1ZXN0aW5nIG1vcmUgdGhlbiBvdXIgbWF4IG51bWJlciBvZiBwcm9kdWN0cy5cblx0Ly8gXHRpZiAobnVtUHJvZHVjdHMgPiB0aGlzLl9tb3N0UmVjZW50TGltaXQpIHsgbnVtUHJvZHVjdHMgPSB0aGlzLl9tb3N0UmVjZW50TGltaXQ7IH1cblx0Ly8gXHRpZiAoIXRoaXMuX3Byb2R1Y3RMaXN0aW5nKSB7IGF3YWl0IHRoaXMuZ2V0RnVsbFByb2R1Y3RMaXN0aW5nKCk7IH1cblx0Ly8gXHRsZXQgcHJvZExpc3RpbmdTdWJzZXQgPSB0aGlzLl9wcm9kdWN0TGlzdGluZy5zbGljZSgwLG51bVByb2R1Y3RzKTtcblx0Ly8gXHRsZXQgcHJvZEZ1bGxUZXh0cyA9IGF3YWl0IHRoaXMuZ2V0UHJvZHVjdHNGdWxsdGV4dChwcm9kTGlzdGluZ1N1YnNldCk7XG5cblx0XHRcblx0Ly8gXHRpZiAoY2FsbGJhY2spICB7IGNhbGxiYWNrKHByb2RGdWxsVGV4dHMsLi4uYXJncyk7IH1cblx0Ly8gXHRlbHNlIHsgcmV0dXJuIHByb2RGdWxsVGV4dHM7IH1cblx0Ly8gfVxuXG5cdC8vR2V0IGFsbCBwcm9kdWN0cyBmcm9tIHRoZSBjdXJyZW50IHByb2R1Y3QgbGlzdGluZy4gIE5vdGUgY2F1dGlvbiBoYXMgdG8gYmUgdXNlZCB3aXRoIHRoaXMuXG5cdC8vUGVyaGFwcyBJIG5lZWQgYW5vdGhlciBtYXhpbXVtIG9yIHJhdGUgbGltaXRlciB0byBub3QgYWxsb3cgZm9sa3MgdG8gYWNjaWRldG5hbGx5IHF1ZXJ5IDUwMDAgcHJvZHVjdHM/XG5cdGFzeW5jIGdldEFsbChjYWxsYmFjaywuLi5hcmdzKXtcblx0XHRsZXQgcHJvZExpc3RpbmdTdWJzZXQgPSBbXTtcblx0XHQvL0lmIHdlIGhhdmVuJ3QgcXVlcnlpZWQgb3VyIHByb2R1Y3QgbGlzdGluZyB5ZXQsIGxldHMgZ2V0IGl0IG92ZXIgd2l0aC5cblx0XHRpZiAoIXRoaXMuX3Byb2R1Y3RMaXN0aW5nKSB7IHByb2RMaXN0aW5nU3Vic2V0ID0gYXdhaXQgdGhpcy5nZXRGdWxsUHJvZHVjdExpc3RpbmcoKTsgfVxuXHRcdGVsc2UgeyBwcm9kTGlzdGluZ1N1YnNldCA9IHRoaXMuX3Byb2R1Y3RMaXN0aW5nOyB9XG5cblx0XHQvL0lmIGEgbGltaXQgaXNuJ3Qgc2V0IChieSBhY2NpZGVudCksIHRoZSBhbW91bnQgb2YgcmF3IHByb2R1Y3RzIHJldHVybmVkIHdvdWxkIG92ZXJ3aGVsbSB0aGUgc3lzdGVtIHdpdGggYWpheCByZXF1ZXN0cy4gXG5cdFx0Ly9TbyBieSBkZWZhdWx0LCB3ZSdyZSBnb2luZyB0byBsaW1pdCBwcm9kdWN0cyB0byB0aGUgX2dldEFsbExpbWl0IHZhcmlhYmxlLiAgVGhpcyB3aWxsIGJlIG92ZXJyaWRlbnQgaWYgbGltaXQgaXMgc2V0IGhpZ2hlciBcblx0XHQvL3doZW4gaW5pdGlhdGluZyB0aGUgY2xhc3MuXG5cdFx0aWYgKCF0aGlzLl9maWx0ZXJzLmxpbWl0KSB7IHByb2RMaXN0aW5nU3Vic2V0ID0gcHJvZExpc3RpbmdTdWJzZXQuc2xpY2UoMCx0aGlzLl9nZXRBbGxMaW1pdCk7IH1cblx0XHQvL2lmIChwcm9kTGlzdGluZ1N1YnNldC5sZW5ndGggPiB0aGlzLl9nZXRBbGxMaW1pdCkgeyBwcm9kTGlzdGluZ1N1YnNldCA9IHByb2RMaXN0aW5nU3Vic2V0LnNsaWNlKDAsdGhpcy5fZ2V0QWxsTGltaXQpOyB9XG5cdFx0XG5cdFx0bGV0IHByb2RGdWxsVGV4dHMgPSBhd2FpdCB0aGlzLmdldFByb2R1Y3RzRnVsbHRleHQocHJvZExpc3RpbmdTdWJzZXQpO1xuXHRcdGlmIChjYWxsYmFjaykgIHsgY2FsbGJhY2socHJvZEZ1bGxUZXh0cywuLi5hcmdzKTsgfVxuXHRcdGVsc2UgeyByZXR1cm4gcHJvZEZ1bGxUZXh0czsgfVxuXHR9XG5cdFxuXHQvL0dldCBhbiBhcnJheSBvZiBhbGwgcHJvZHVjdHMgbGlzdGVkIGluIHRoZSBsaXN0aW5nLlxuXHRhc3luYyBnZXRQcm9kdWN0c0Z1bGx0ZXh0KHByb2R1Y3RMaXN0aW5nKXtcblx0XHRsZXQgcHJvZHVjdFRleHRzID0gW107XG5cdFx0aWYgKHByb2R1Y3RMaXN0aW5nLmxlbmd0aCAhPT0gMCkge1xuXHRcdFx0bGV0IHVybHMgPSBwcm9kdWN0TGlzdGluZy5tYXAoIHByb2QgPT4gcHJvZFsnQGlkJ10pO1x0XHRcdFxuXHRcdFx0cHJvZHVjdFRleHRzID0gYXdhaXQgdGhpcy5yZXRyeUZldGNoQWxsSnNvbih1cmxzLCBudWxsLCB0aGlzLl9yZXF1ZXN0UmV0cnlUaW1lb3V0LCB0aGlzLl9yZXF1ZXN0UmV0cnlMaW1pdCk7XG5cdFx0fSBcblx0XHRyZXR1cm4gcHJvZHVjdFRleHRzO1xuXHR9XG5cblx0Ly9SZXR1cm5zIHRoZSBsYXRlc3QgcHJvZHVjdFxuLypcdGFzeW5jIGdldExhdGVzdChjYWxsYmFjaywuLi5hcmdzKXtcblx0XHR0aGlzLmdldE1vc3RSZWNlbnQoMSxjYWxsYmFjaywuLi5hcmdzKVxuXHR9Ki9cblxuXG5cdFxuLypcdC8vUmV0dXJucyBhbGwgb3IgYSBzdWJzZXQgb2YgdGhlIHByb2R1Y3RzXG5cdGFzeW5jIGJ5U3Vic2V0KGlkeCxjYWxsYmFjaywuLi5hcmdzKXtcblx0XHRsZXQganNvbiA9IFtdO1xuXHRcdGxldCBwcm9kQXJyYXkgPSB0aGlzLl9wcm9kdWN0TGlzdGluZ1snQGdyYXBoJ107XG5cdFx0aWYgKHByb2RBcnJheS5sZW5ndGggIT09IDApIHtcdFxuXHRcdFx0Ly9zbGljZSBvZmYgYW55IGV4dHJhIGlmIGEgbGltaXQgaXMgc2V0LlxuXHRcdFx0aWYgKHRoaXMuX2xpbWl0KSB7IHByb2RBcnJheSA9IHByb2RBcnJheS5zbGljZSgwLHRoaXMuX2xpbWl0ICl9XG5cblx0XHRcdGpzb24gPSBhd2FpdCBQcm9taXNlLmFsbChcblx0XHRcdFx0cHJvZEFycmF5Lm1hcChhc3luYyBwcm9kID0+IHtcblx0XHRcdFx0XHR2YXIgdXJsID0gcHJvZFsnQGlkJ107XG5cdFx0XHRcdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwpXG5cdFx0XHRcdFx0cmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcblx0XHRcdFx0fSlcblx0XHRcdClcblx0XHR9XG5cdFx0aWYgKGNhbGxiYWNrKSAgeyBjYWxsYmFjayhqc29uLC4uLmFyZ3MpOyB9XG5cdFx0ZWxzZSB7IHJldHVybiBqc29uOyB9XG5cdH1cbiovXG59XG5cblxuXG4vKlxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUHJvZHVjdHMge1xuXHRcblx0Y29uc3RydWN0b3IodHlwZSA9IG51bGwsIHdmbyA9IG51bGwsIGlkeCA9IGZhbHNlLCBsaW1pdCA9IGZhbHNlLCBzdGFydERhdGUgPSBmYWxzZSwgZW5kRGF0ZSA9IGZhbHNlKSB7XG5cdFx0dGhpcy5fYmFzZVVybCA9ICdodHRwczovL2FwaS53ZWF0aGVyLmdvdi8nO1xuXHRcdHRoaXMuX3Byb2R1Y3RzVXJsID0gJ3Byb2R1Y3RzJ1xuXHRcdHRoaXMuX2xvY2F0aW9uc1VybCA9ICcvbG9jYXRpb25zJ1xuXHRcdHRoaXMuX3R5cGVzVXJsID0gJy90eXBlcyc7XG5cblx0XHR0aGlzLl90eXBlID0gdHlwZTtcblx0XHR0aGlzLl93Zm8gPSB3Zm87XG5cdFx0dGhpcy5faWR4ID0gaWR4O1xuXHRcdHRoaXMuX2xpbWl0ID0gbGltaXQ7XG5cdFx0dGhpcy5fc3RhcnREYXRlID0gc3RhcnREYXRlO1xuXHRcdHRoaXMuX2VuZERhdGUgPSBlbmREYXRlO1xuXHRcdHRoaXMuX3Byb2R1Y3RMaXN0aW5nID0gbnVsbFxuXHR9XG5cblx0Ly9SZXR1cm5zIGEgc2luZ2xlIHByb2R1Y3QgYnkgYW4gaW5kZXhcblx0YXN5bmMgYnlJbmRleChpZHgsY2FsbGJhY2ssLi4uYXJncyl7XG5cdFx0bGV0IGpzb24gPSB7fTtcblx0XHRpZiAodGhpcy5fcHJvZHVjdExpc3RpbmdbJ0BncmFwaCddLmxlbmd0aCAhPT0gMCkge1xuXHRcdFx0dmFyIHVybCA9IHRoaXMuX3Byb2R1Y3RMaXN0aW5nWydAZ3JhcGgnXVt0aGlzLl9pZHhdWydAaWQnXTtcblx0XHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsKVxuXHRcdFx0anNvbiA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblx0XHR9XG5cdFx0aWYgKGNhbGxiYWNrKSAgeyBjYWxsYmFjayhqc29uLC4uLmFyZ3MpOyB9XG5cdFx0ZWxzZSB7IHJldHVybiBqc29uOyB9XG5cdH1cblxuXHQvL1JldHVybnMgYWxsIG9yIGEgc3Vic2V0IG9mIHRoZSBwcm9kdWN0c1xuXHRhc3luYyBieVN1YnNldChpZHgsY2FsbGJhY2ssLi4uYXJncyl7XG5cdFx0bGV0IGpzb24gPSBbXTtcblx0XHRsZXQgcHJvZEFycmF5ID0gdGhpcy5fcHJvZHVjdExpc3RpbmdbJ0BncmFwaCddO1xuXHRcdGlmIChwcm9kQXJyYXkubGVuZ3RoICE9PSAwKSB7XG5cdFx0XHRcdC8vZmlsdGVyIG91dCBieSBzdGFydCBkYXRlXG5cdFx0XHRpZiAodGhpcy5fc3RhcnREYXRlKSB7IFxuXHRcdFx0XHRwcm9kQXJyYXkgPSBwcm9kQXJyYXkuZmlsdGVyKCBwcm9kdWN0ID0+IHtcblx0XHRcdFx0XHRyZXR1cm4gdGhpcy5fc3RhcnREYXRlIDwgbmV3IERhdGUocHJvZHVjdC5pc3N1YW5jZVRpbWUpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHRcdGlmICh0aGlzLl9lbmREYXRlKSB7IFxuXHRcdFx0XHRwcm9kQXJyYXkgPSBwcm9kQXJyYXkuZmlsdGVyKCBwcm9kdWN0ID0+IHtcblx0XHRcdFx0XHRyZXR1cm4gdGhpcy5fZW5kRGF0ZSA+IG5ldyBEYXRlKHByb2R1Y3QuaXNzdWFuY2VUaW1lKVxuXHRcdFx0XHR9KVxuXHRcdFx0fVx0XHRcdFxuXHRcdFx0Ly9zbGljZSBvZmYgYW55IGV4dHJhIGlmIGEgbGltaXQgaXMgc2V0LlxuXHRcdFx0aWYgKHRoaXMuX2xpbWl0KSB7IHByb2RBcnJheSA9IHByb2RBcnJheS5zbGljZSgwLHRoaXMuX2xpbWl0ICl9XG5cblx0XHRcdGpzb24gPSBhd2FpdCBQcm9taXNlLmFsbChcblx0XHRcdFx0cHJvZEFycmF5Lm1hcChhc3luYyBwcm9kID0+IHtcblx0XHRcdFx0XHR2YXIgdXJsID0gcHJvZFsnQGlkJ107XG5cdFx0XHRcdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwpXG5cdFx0XHRcdFx0cmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcblx0XHRcdFx0fSlcblx0XHRcdClcblx0XHR9XG5cdFx0aWYgKGNhbGxiYWNrKSAgeyBjYWxsYmFjayhqc29uLC4uLmFyZ3MpOyB9XG5cdFx0ZWxzZSB7IHJldHVybiBqc29uOyB9XG5cdH1cblxuXHRhc3luYyBnZXRQcm9kdWN0c0J5TG9jYXRpb25BbmRUeXBlKGNhbGxiYWNrLC4uLmFyZ3Mpe1xuXHRcdGlmICgodGhpcy5fdHlwZSkgJiYgKHRoaXMuX3dmbykpe1xuXHRcdFx0dmFyIHVybCA9IHRoaXMuX2Jhc2VVcmwrdGhpcy5fcHJvZHVjdHNVcmwrdGhpcy5fdHlwZXNVcmwrJy8nK3RoaXMuX3R5cGUrdGhpcy5fbG9jYXRpb25zVXJsKycvJyt0aGlzLl93Zm9cblx0XHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsKVxuXHRcdFx0dmFyIGpzb24gPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cdFx0XHRsZXQgcHJvZHVjdHM7XG5cdFx0XHR0aGlzLl9wcm9kdWN0TGlzdGluZyA9IGpzb247XG5cblx0XHRcdGlmICh0aGlzLl9pZHggIT09IGZhbHNlKSB7ICBwcm9kdWN0cyA9IGF3YWl0IHRoaXMuYnlJbmRleCgpIH1cblx0XHRcdGVsc2UgeyBwcm9kdWN0cyA9IGF3YWl0IHRoaXMuYnlTdWJzZXQoKSB9XG5cdFx0XHRpZiAoY2FsbGJhY2spIHsgY2FsbGJhY2socHJvZHVjdHMsLi4uYXJncyk7IH1cblx0XHRcdGVsc2UgeyByZXR1cm4gcHJvZHVjdHM7IH1cblx0XHR9XG5cdFx0ZWxzZSB7IHJldHVybiBmYWxzZTsgfVxuXHR9XG59XG4qLyIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdGlmKF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0pIHtcblx0XHRyZXR1cm4gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiLy8gbW9kdWxlIGV4cG9ydHMgbXVzdCBiZSByZXR1cm5lZCBmcm9tIHJ1bnRpbWUgc28gZW50cnkgaW5saW5pbmcgaXMgZGlzYWJsZWRcbi8vIHN0YXJ0dXBcbi8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xucmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oNDIzKTtcbiIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IChleHBvcnRzLCBkZWZpbml0aW9uKSA9PiB7XG5cdGZvcih2YXIga2V5IGluIGRlZmluaXRpb24pIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBkZWZpbml0aW9uW2tleV0gfSk7XG5cdFx0fVxuXHR9XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IChvYmosIHByb3ApID0+IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApIiwiLy8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5yID0gKGV4cG9ydHMpID0+IHtcblx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG5cdH1cblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbn07Il0sInNvdXJjZVJvb3QiOiIifQ==